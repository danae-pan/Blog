"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[6193],{2725:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-1-7a0f8837bba661162cef6b200f1e3154.png"},3687:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-3-d2178dfc2751758ad33ea1b8ab1c2ad0.png"},3795:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-7-c2c4836b59b20798e6ecf167ebf3d68c.png"},5374:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-2-eebd0b9bbbfa684c22e86f2ec6e3d7a3.png"},5704:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/Cicada","editUrl":"https://github.com/danae-pan/Blog/blog/Cicada.md","source":"@site/blog/Cicada.md","title":"Cicada","description":"Task 1","date":"2025-06-15T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"windows","permalink":"/Blog/blog/tags/windows"}],"readingTime":3.58,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Cicada","date":"2025-06-15T00:00:00.000Z","tags":["easy","windows"]},"unlisted":false,"prevItem":{"title":"Two Million","permalink":"/Blog/blog/TwoMillion"},"nextItem":{"title":"Board Light","permalink":"/Blog/blog/BoardLight"}}')},6218:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-6-3faaff942dfef3c5779551800503056d.png"},6385:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-ci-5-c5ee995f367e271c4fee423af0310ef2.png"},6823:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});var n=s(5704),a=s(4848),i=s(8453);const o={title:"Cicada",date:new Date("2025-06-15T00:00:00.000Z"),tags:["easy","windows"]},r=void 0,c={authorsImageUrls:[]},d=[{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4",id:"task-4",level:3}];function l(e){const t={code:"code",h3:"h3",img:"img",p:"p",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,a.jsx)(t.p,{children:"What is the name of the non-default SMB share that is readable with guest access on Cicada?"}),"\n",(0,a.jsxs)(t.p,{children:["Running ",(0,a.jsx)(t.code,{children:"smbclient -N -L //<target_ip>"})," to connect to the share server without providing a password and list the shares we see two non-default shares named ",(0,a.jsx)(t.code,{children:"DEV"})," and ",(0,a.jsx)(t.code,{children:"HR"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(2725).A+"",width:"1546",height:"746"})}),"\n",(0,a.jsxs)(t.p,{children:["Next, to see which one is readable as a guest, we will try to connect to those specific shares. Running ",(0,a.jsx)(t.code,{children:"smbclient -N //<target_ip>/<share_name>"})," we see the one we have access to read is the ",(0,a.jsx)(t.code,{children:"HR"})," share."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(5374).A+"",width:"1546",height:"708"})}),"\n",(0,a.jsx)(t.h3,{id:"task-2",children:"Task 2"}),"\n",(0,a.jsx)(t.p,{children:"What is the name of the file found in the HR share?"}),"\n",(0,a.jsx)(t.p,{children:'Seen in the previous task, from listing the contents of the HR share, the file name is "Notice from HR.txt".'}),"\n",(0,a.jsx)(t.h3,{id:"task-3",children:"Task 3"}),"\n",(0,a.jsx)(t.p,{children:"Which user account is still using the company default password?"}),"\n",(0,a.jsxs)(t.p,{children:["To see the contents of the file found, we can transfer it to the host by running ",(0,a.jsx)(t.code,{children:'get "Notice from HR'}),'.txt". Opening it, we see a welcoming message to a new hire with the default password but it does not give a username']}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(3687).A+"",width:"1546",height:"506"})}),"\n",(0,a.jsxs)(t.p,{children:["Then, we can try to enumerate domain users on the target IP and save them to a file by running ",(0,a.jsx)(t.code,{children:"lookupsid.py anonymous@<target_ip> > lookupsid_output.txt"}),". Then, we save the usernames cleanly we run ",(0,a.jsx)(t.code,{children:"grep '(SidTypeUser)' lookupsid_output.txt | awk -F '\\\\' '{print $2}' | cut -d' ' -f1 > users.txt"}),".  Finally using the password found in the file, we can perform a password spray attack by running ",(0,a.jsx)(t.code,{children:"netexec smb <target_ip> -u users.txt -p 'Cicada$M6Corpb*@Lp#nZp!8'"})," and find the username to be michael.wrightson."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(6385).A+"",width:"2286",height:"812"})}),"\n",(0,a.jsx)(t.h3,{id:"task-4",children:"Task 4"}),"\n",(0,a.jsx)(t.p,{children:"Which user has left their password in Active Directory metadata?"}),"\n",(0,a.jsxs)(t.p,{children:["We dump the AD metadata using ",(0,a.jsx)(t.code,{children:"ldapdomaindump -u cicada.htb\\\\michael.wrightson -p 'Cicada$M6Corpb*@Lp#nZp!8' <target_ip>"}),". We then try the command ",(0,a.jsx)(t.code,{children:"grep -iE 'pass|key|desc|comment' domain_users.json"})," to look for password in the file matching any lines that contain the mentioned keywords."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(6218).A+"",width:"1696",height:"808"})}),"\n",(0,a.jsxs)(t.p,{children:["After finding the password we can try to connect with it using the users.txt file from the previous task as ",(0,a.jsx)(t.code,{children:"netexec smb <target_ip> -u users.txt -p 'aRt$Lp#7t*VQ!3'"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:s(3795).A+"",width:"1696",height:"974"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>r});var n=s(6540);const a={},i=n.createContext(a);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);