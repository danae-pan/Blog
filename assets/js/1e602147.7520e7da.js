"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[3591],{172:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-7-ab253a260d6d01db60452538f318c328.png"},231:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-4-e99f4bf3d12c749acf74390dadd83c18.png"},668:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/Writeup","editUrl":"https://github.com/danae-pan/Blog/blog/Writeup.md","source":"@site/blog/Writeup.md","title":"Writeup","description":"Task 1","date":"2025-05-12T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"linux","permalink":"/Blog/blog/tags/linux"}],"readingTime":2.535,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Writeup","date":"2025-05-12T00:00:00.000Z","tags":["easy","linux"]},"unlisted":false,"prevItem":{"title":"Precious","permalink":"/Blog/blog/Precious"},"nextItem":{"title":"Paper","permalink":"/Blog/blog/Paper"}}')},1558:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>n,toc:()=>o});var n=s(668),i=s(4848),a=s(8453);const r={title:"Writeup",date:new Date("2025-05-12T00:00:00.000Z"),tags:["easy","linux"]},c=void 0,d={authorsImageUrls:[]},o=[{value:"Task 1",id:"task-1",level:3}];function h(e){const t={code:"code",h3:"h3",img:"img",p:"p",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,i.jsx)(t.p,{children:"Submit user flag."}),"\n",(0,i.jsx)(t.p,{children:"Opening the browser to the IP address of the target it is revealed that the web site uses DDoS protection."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(2929).A+"",width:"1600",height:"536"})}),"\n",(0,i.jsxs)(t.p,{children:["Navigating to ",(0,i.jsx)(t.code,{children:"/robots.txt"})," we can see that there is a path called ",(0,i.jsx)(t.code,{children:"writeup/"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(8712).A+"",width:"1366",height:"666"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"writeup/"})," path shows the following page:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(231).A+"",width:"1914",height:"964"})}),"\n",(0,i.jsxs)(t.p,{children:["Running ",(0,i.jsx)(t.code,{children:"whatweb"})," against the website ",(0,i.jsx)(t.code,{children:"whatweb <target_ip>/writeup -v"})," we find the CMS to be ",(0,i.jsx)(t.code,{children:"CMS Made Simple"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(1918).A+"",width:"2146",height:"438"})}),"\n",(0,i.jsxs)(t.p,{children:["We can then try the directories used which can be found at ",(0,i.jsx)(t.code,{children:"http://svn.cmsmadesimple.org/svn/cmsmadesimple/trunk/"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Trying out the path ",(0,i.jsx)(t.code,{children:"admin/"})," we get a pop-up to authenticate, default credentials ",(0,i.jsx)(t.code,{children:"username=admin"})," and ",(0,i.jsx)(t.code,{children:"password=admin"})," did not get us in."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(9269).A+"",width:"1042",height:"610"})}),"\n",(0,i.jsxs)(t.p,{children:["Next, other directories are being tried to find the version of the CMS. At ",(0,i.jsx)(t.code,{children:"doc/CHANGELOG.txt"})," we found that the version is 2.2.9.1."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(172).A+"",width:"1042",height:"492"})}),"\n",(0,i.jsxs)(t.p,{children:["Using ",(0,i.jsx)(t.code,{children:"searchsploit CMS Made Simple"})," we search for exploits and find versions lower than 2.2.10 are vulnerable to SQL Injection."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:s(7979).A+"",width:"1420",height:"106"})}),"\n",(0,i.jsxs)(t.p,{children:["We can then copy the exploit from searchsploitby running ",(0,i.jsx)(t.code,{children:"searchsploit -m php/webapps/46635.py"})," and run it by ",(0,i.jsx)(t.code,{children:"python3 46635.py -u http://<target_ip>/writeup/ -c -w rocktou.txt"})," where the -c switch is specified to crack the detected password. The script detects the credentials which we can then use for the admin login prompt. This did not work but after trying ssh with the same credentials ",(0,i.jsx)(t.code,{children:"ssh <username>@<target_ip>"})," we get in and find the user flag on the home directory of the user by ",(0,i.jsx)(t.code,{children:"cat user.txt"}),"."]})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1918:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-5-ea80ef4d3ec4d054597c85373da15a6d.png"},2929:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-2-edee0b487498a35ab805b00c27472d19.png"},7979:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-8-c074d0f78a42b5f2bf32d1349d5aad5e.png"},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>c});var n=s(6540);const i={},a=n.createContext(i);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:t},e.children)}},8712:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-3-fd2dfec598f7f566bc34c6788ff09209.png"},9269:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image-w-6-309cf4b61982bcc6601ef5fd7ffc18a6.png"}}]);