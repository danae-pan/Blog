"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[4260],{2206:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image-g-5-14f9524c6351ec8b2949c6aabdb1699a.png"},3252:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image-g-619aec147bcca7992c4a856afd59376d.png"},6509:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/GoodGames","editUrl":"https://github.com/danae-pan/Blog/blog/GoodGames.md","source":"@site/blog/GoodGames.md","title":"Good Games","description":"Task 1","date":"2025-04-20T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"windows","permalink":"/Blog/blog/tags/windows"}],"readingTime":4.89,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Good Games","date":"2025-04-20T00:00:00.000Z","tags":["easy","windows"]},"unlisted":false,"prevItem":{"title":"Devvortex","permalink":"/Blog/blog/Devvortex"},"nextItem":{"title":"Sau","permalink":"/Blog/blog/Sau"}}')},7960:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var a=n(6509),s=n(4848),i=n(8453);const o={title:"Good Games",date:new Date("2025-04-20T00:00:00.000Z"),tags:["easy","windows"]},r=void 0,l={authorsImageUrls:[]},d=[{value:"Task 1",id:"task-1",level:3}];function c(e){const t={code:"code",h3:"h3",img:"img",p:"p",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,s.jsx)(t.p,{children:"Submit User Flag"}),"\n",(0,s.jsx)(t.p,{children:"We use nmap to find the services on the target machine and we see that an apache server runs on port 80."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"nmap -sV target_ip"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(3252).A+"",width:"800",height:"325"})}),"\n",(0,s.jsx)(t.p,{children:"Navigating to the browser we see a login page where we will try bypassing the authentication using SQL injection."}),"\n",(0,s.jsx)(t.p,{children:"Server-Side Template Injection (SSTI) vulnerability arises when an application incorporates user-supplied input directly into its server-side templates without proper sanitization or validation. Template engines, which combine templates with dynamic data to generate web pages, can be exploited through SSTI attacks."}),"\n",(0,s.jsx)(t.p,{children:"To find forms that are candidates for sql injection run"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'sqlmap -u "http://10.129.51.14/" --forms --crawl=2 --dbms=mysql'})}),"\n",(0,s.jsx)(t.p,{children:"--crawl=CRAWLDEPTH: crawls the website starting from the target url"}),"\n",(0,s.jsx)(t.p,{children:"We find a total of 8 targets. One of the identified forms is the login form and sqlmap auto-filled blank fields, tried multiple techniques and identified that the email field is vulnerable to time-based blind SQL injection."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(9560).A+"",width:"816",height:"485"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(2206).A+"",width:"816",height:"264"})}),"\n",(0,s.jsx)(t.p,{children:"After confirming the vulnerability we want to enumerate the database and find the table storing the usernames and passwords to get the user flag."}),"\n",(0,s.jsx)(t.p,{children:"We can try running the following command to retrieve the databse names."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'sqlmap -u "http://10.129.51.14/login" --data="email=*&password=test123" --dbs'})}),"\n",(0,s.jsx)(t.p,{children:"We found 2 available databases named information_schema and main."}),"\n",(0,s.jsx)(t.p,{children:"Next, we will list the tables from each."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'sqlmap -u "http://10.129.51.14/login" --data="email=*&password=test123/login" -D <database_name> --tables'})}),"\n",(0,s.jsx)(t.p,{children:"Starting with the database named main, we find 3 tables blog, blog_comments and user and which we can further investigate.\nWe start with the table user."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'sqlmap -u "http://10.129.51.14/login" --data="email=*&password=test123/login" -D main -T user --columns'})}),"\n",(0,s.jsx)(t.p,{children:"There, we find 4 columns in total with a column named email and a column name password that might get us the flags we need."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(8658).A+"",width:"1228",height:"536"})}),"\n",(0,s.jsx)(t.p,{children:"We then run the following command to retreive that information."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'sqlmap -u "http://10.129.51.14/login" --data="email=*&password=test123/login" -D main -T user -C email,password --dump'})}),"\n",(0,s.jsx)(t.p,{children:"We find the email and the password and with those credentials we login after we use a hash cracker to find the plain texts password from the hashed one."}),"\n",(0,s.jsx)(t.p,{children:"Now that we are logged in as admin, we can see a gear on the top right that redirects as to internal-administration.goodgames.htb. We need to edit the /etc/hosts file to point this domain to the target machine's IP.\nNote, editing the hosts file requires administrative privileges."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var a=n(6540);const s={},i=a.createContext(s);function o(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:t},e.children)}},8658:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image-g-9-708f4e42c7a8b057b1491a527b02dd4c.png"},9560:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image-g-3-8ddec9f638f40155c2cfce60b335ca99.png"}}]);