"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[7026],{345:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-1-44a5e88fc5d4b4bf08a2d53f807be20a.png"},555:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-3-e8a46b7e6da7df0a7bcbf4aee440ccdc.png"},612:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-4-8c05b368bb63181127adc02b441811e0.png"},4656:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>d,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>h});var i=n(5333),a=n(4848),s=n(8453);const o={title:"Two Million",date:new Date("2025-08-02T00:00:00.000Z"),tags:["easy","linux"]},d=void 0,r={authorsImageUrls:[]},h=[{value:"Task 1",id:"task-1",level:3},{value:"Task 2",id:"task-2",level:3},{value:"Task 3",id:"task-3",level:3},{value:"Task 4",id:"task-4",level:3},{value:"Task 5",id:"task-5",level:3},{value:"Task 6",id:"task-6",level:3},{value:"Task 7",id:"task-7",level:3}];function c(e){const t={code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h3,{id:"task-1",children:"Task 1"}),"\n",(0,a.jsx)(t.p,{children:"How many TCP ports are open?"}),"\n",(0,a.jsxs)(t.p,{children:["Running ",(0,a.jsx)(t.code,{children:"nmap -sS <target_ip>"})," we see two ports open on the target system."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(345).A+"",width:"801",height:"203"})}),"\n",(0,a.jsx)(t.h3,{id:"task-2",children:"Task 2"}),"\n",(0,a.jsx)(t.p,{children:"What is the name of the JavaScript file loaded by the /invite page that has to do with invite codes?"}),"\n",(0,a.jsxs)(t.p,{children:["Navigating to the target IP on the browser we see that the server is not found. After adding the target IP on the host file using the command ",(0,a.jsx)(t.code,{children:"sudo vim /etc/hosts"})," with the domain name being ",(0,a.jsx)(t.code,{children:"2million.htb"})," we can refresh the page and navigate to the /invite page. There, we see a sign-up/login form."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(5202).A+"",width:"590",height:"318"})}),"\n",(0,a.jsxs)(t.p,{children:["Viewing the page source and searching for any Javascript file, we locate the following, having the name ",(0,a.jsx)(t.code,{children:"inviteapi.min.js"}),":"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(555).A+"",width:"922",height:"530"})}),"\n",(0,a.jsx)(t.h3,{id:"task-3",children:"Task 3"}),"\n",(0,a.jsx)(t.p,{children:"What JavaScript function on the invite page returns the first hint about how to get an invite code? Don't include () in the answer."}),"\n",(0,a.jsxs)(t.p,{children:["Opening the previous file, we locate the function ",(0,a.jsx)(t.code,{children:"makeInviteCode"})," that is the Javascript function returning the first hint."]}),"\n",(0,a.jsx)(t.h3,{id:"task-4",children:"Task 4"}),"\n",(0,a.jsx)(t.p,{children:"The endpoint in makeInviteCode returns encrypted data. That message provides another endpoint to query. That endpoint returns a code value that is encoded with what very common binary to text encoding format. What is the name of that encoding?"}),"\n",(0,a.jsxs)(t.p,{children:["First, opening the console on the developer tools, we call the function by ",(0,a.jsx)(t.code,{children:"makeInviteCode"})," and observe the result:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(612).A+"",width:"1001",height:"399"})}),"\n",(0,a.jsxs)(t.p,{children:["We see that the data is encoded with ROT13, so we can decode the value of the field ",(0,a.jsx)(t.code,{children:"data"}),' using any ROT13 decoder and we get the message "In order to generate the invite code, make a POST request to /api/v1/invite/generate". So, we can use ',(0,a.jsx)(t.code,{children:"fetch"})," in the browser console to query this endpoint by:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"fetch('/api/v1/invite/generate', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' }\n})\n  .then(res => res.json())\n  .then(data => console.log(data));\n"})}),"\n",(0,a.jsx)(t.p,{children:"As a response, we see the code that is encoded using Base64."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(6765).A+"",width:"542",height:"74"})}),"\n",(0,a.jsx)(t.h3,{id:"task-5",children:"Task 5"}),"\n",(0,a.jsx)(t.p,{children:'What is the path to the endpoint the page uses when a user clicks on "Connection Pack"?'}),"\n",(0,a.jsx)(t.p,{children:'First, we decode the code from the previous task and use it to sign up and register for an account. We then login and look for the "Connection Pack". We find it under the "Access" page, we open the tools on the Network tab and clicking the button. On the Headers tab of the request we see the API endpoint where the GET function sends the request.'}),"\n",(0,a.jsx)(t.h3,{id:"task-6",children:"Task 6"}),"\n",(0,a.jsx)(t.p,{children:"How many API endpoints are there under /api/v1/admin?"}),"\n",(0,a.jsxs)(t.p,{children:["By navigating to the endpoint ",(0,a.jsx)(t.code,{children:"/api/v1"})," we can see a list of endpoints including admin."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"alt text",src:n(6086).A+"",width:"569",height:"429"})}),"\n",(0,a.jsx)(t.h3,{id:"task-7",children:"Task 7"}),"\n",(0,a.jsx)(t.p,{children:"What API endpoint can change a user account to an admin account?"}),"\n",(0,a.jsxs)(t.p,{children:["Inspecting the result from the previous task we see that he desired endpoint is ",(0,a.jsx)(t.code,{children:"/api/v1/admin/settings/update"}),"."]})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},5202:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-2-a7054f9e4d1c11f2e9dfe305242ec1c7.png"},5333:e=>{e.exports=JSON.parse('{"permalink":"/Blog/blog/TwoMillion","editUrl":"https://github.com/danae-pan/Blog/blog/TwoMillion.md","source":"@site/blog/TwoMillion.md","title":"Two Million","description":"Task 1","date":"2025-08-02T00:00:00.000Z","tags":[{"inline":true,"label":"easy","permalink":"/Blog/blog/tags/easy"},{"inline":true,"label":"linux","permalink":"/Blog/blog/tags/linux"}],"readingTime":5.705,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Two Million","date":"2025-08-02T00:00:00.000Z","tags":["easy","linux"]},"unlisted":false,"nextItem":{"title":"Cicada","permalink":"/Blog/blog/Cicada"}}')},6086:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-6-58a64bab300755410abbd3eb3d884a70.png"},6765:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/image-t-5-f120ebc9d3aa6a80628771bdffd19f93.png"},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>d});var i=n(6540);const a={},s=i.createContext(a);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);